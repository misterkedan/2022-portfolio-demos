(()=>{"use strict";const t=THREE;function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var r=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e(this,t),this.callbacks="function"==typeof i?[i]:i,this.fps=r,this.elapsed=0,this._last=0,this._deltaOffset=0,this._isPlaying=!1,this._update=this.update.bind(this)}var r,n,o;return r=t,(n=[{key:"add",value:function(t){this.has(t)||this.callbacks.push(t)}},{key:"remove",value:function(t){this.has(t)&&this.callbacks.splice(this.callbacks.indexOf(t),1)}},{key:"has",value:function(t){return this.callbacks.includes(t)}},{key:"reset",value:function(){this.elapsed=0}},{key:"start",value:function(){this._last=this.now,this._deltaOffset=0,this._isPlaying=!0,this.requestFrame()}},{key:"pause",value:function(){this._isPlaying=!1}},{key:"stop",value:function(){this.pause(),this.reset()}},{key:"update",value:function(){if(this.isPlaying){this.requestFrame();var e=Math.min(this.now-this._last,t.maxDelta);if(this._last=this.now,this.elapsed+=e,e>=this._frameDuration)return this.tick(e);this._deltaOffset+=e;var i=this._frameDuration-this._deltaOffset;i<=0&&(this.tick(this._frameDuration),this._deltaOffset=Math.abs(i)%this._frameDuration)}}},{key:"tick",value:function(t){var e=this;this.callbacks.forEach((function(i){return i(t,e.elapsed)}))}},{key:"requestFrame",value:function(){requestAnimationFrame(this._update)}},{key:"fps",get:function(){return this._fps},set:function(t){this._fps=t,this._frameDuration=t>0?Math.floor(1e3/t):0}},{key:"isPlaying",get:function(){return this._isPlaying}},{key:"now",get:function(){return t.time.now()}}])&&i(r.prototype,n),o&&i(r,o),Object.defineProperty(r,"prototype",{writable:!1}),t}();function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}r.maxDelta=100,r.time=Date||performance;var s=function(){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=i.container,s=void 0===o?"sketch":o,a=i.width,l=i.height,h=i.fps,c=void 0===h?60:h,u=i.renderer,d=void 0===u?new t.WebGLRenderer({powerPreference:"high-performance",antialias:!1,stencil:!1,depth:!1}):u;n(this,e),this.renderer=d,this.canvas=d.domElement,this.pixelRatio=Math.min(window.devicePixelRatio,2),"string"==typeof s&&(s=document.getElementById(s)),s||(s=document.body),s.appendChild(this.canvas),s.style.touchAction="none",this.width=a>0?a:void 0,this.height=l>0?l:void 0,this.fps=c,this.onTick=this.tick.bind(this),this.ticker=new r(this.onTick,c)}var i,s,a;return i=e,s=[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sketch;this.sketch=t,this.resize(),this.sketch.init(),this.onResize=function(){this.needsResize=!0}.bind(this),window.addEventListener("resize",this.onResize),this.onTouchStart=function(t){return t.preventDefault()},this.canvas.addEventListener("touchstart",this.onTouchStart),this.tick(0,0),this.ticker.start()}},{key:"dispose",value:function(){this.ticker.stop(),window.removeEventListener("resize",this.onResize),window.removeEventListener("touchstart",this.onTouchStart)}},{key:"resize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.width,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.height;t||(t=window.innerWidth),e||(e=window.innerHeight),this.renderer.setPixelRatio(this.pixelRatio),this.renderer.setSize(t,e),this.sketch.resize(t,e,this.pixelRatio),this.needsResize=!1}},{key:"tick",value:function(t,e){this.needsResize&&this.resize(),this.sketch.tick(t,e)}}],s&&o(i.prototype,s),a&&o(i,a),Object.defineProperty(i,"prototype",{writable:!1}),e}();class a{constructor(t=Math){this.prng=t}random(){return this.prng.random()}amount(){return this.random()}number(t=0,e=1,i=!1){const r=this.random();return isNaN(t)||isNaN(e)?r:i?Math.floor(r*(e-t+1)+t):r*(e-t)+t}noise(){return this.number(-1,1)}int(t,e){return this.number(t,e,!0)}uint(t){return this.int(0,t)}boolean(){return this.random()<.5}chance(t){return this.random()<t}item(t){return t[this.uint(t.length-1)]}char(t){return t.charAt(this.uint(t.length-1))}}const l="vec3 bayerMatrixDither( vec3 color ) {\r\n\r\n\tconst float BAYER_MATRIX[ 64 ] = float[ 64 ](\r\n\t\t0.0,  32.0,  8.0, 40.0,  2.0, 34.0, 10.0, 42.0,\r\n\t\t48.0, 16.0, 56.0, 24.0, 50.0, 18.0, 58.0, 26.0,\r\n\t\t12.0, 44.0,  4.0, 36.0, 14.0, 46.0,  6.0, 38.0,\r\n\t\t60.0, 28.0, 52.0, 20.0, 62.0, 30.0, 54.0, 22.0,\r\n\t\t3.0,  35.0, 11.0, 43.0,  1.0, 33.0,  9.0, 41.0,\r\n\t\t51.0, 19.0, 59.0, 27.0, 49.0, 17.0, 57.0, 25.0,\r\n\t\t15.0, 47.0,  7.0, 39.0, 13.0, 45.0,  5.0, 37.0,\r\n\t\t63.0, 31.0, 55.0, 23.0, 61.0, 29.0, 53.0, 21.0\r\n\t);\r\n\r\n\tfloat dithering = ( BAYER_MATRIX[  \r\n\t\tint( mod( gl_FragCoord.x - 0.5, 8.0 ) ) + \r\n\t\tint( mod( gl_FragCoord.y - 0.5, 8.0 ) * 8.0 )\r\n\t] / 255.0 ) / 32.0 - ( 1.0 / 128.0 );\r\n\r\n\treturn color + dithering;\r\n\t\r\n}";function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function u(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){d(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v(t,e){return v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},v(t,e)}function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=b(t);if(e){var n=b(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return g(this,i)}}function g(t,e){if(e&&("object"===h(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}var y=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&v(t,e)}(s,e);var i,r,n,o=m(s);function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.color1,r=void 0===i?16777215:i,n=e.color2,a=void 0===n?0:n,l=e.angle,h=void 0===l?90:l;f(this,s);var c=new t.PlaneGeometry(2,2),d=new t.ShaderMaterial(u(u({},s.shader),{},{uniforms:{uAngle:{value:h},uColor1:{value:new t.Color(r)},uColor2:{value:new t.Color(a)}}}));return o.call(this,c,d)}return i=s,(r=[{key:"angle",get:function(){return this.material.uniforms.uAngle.value},set:function(t){this.material.uniforms.uAngle.value=t}},{key:"color1",get:function(){return this.material.uniforms.uColor1.value},set:function(t){this.material.uniforms.uColor1.value=t}},{key:"color2",get:function(){return this.material.uniforms.uColor2.value},set:function(t){this.material.uniforms.uColor2.value=t}}])&&p(i.prototype,r),n&&p(i,n),Object.defineProperty(i,"prototype",{writable:!1}),s}(t.Mesh);y.shader={depthWrite:!1,depthTest:!1,vertexShader:"varying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\r\n\tgl_Position = vec4( position, 1.0 );\r\n\r\n}",fragmentShader:"\n\t\tuniform float uAngle;\n\t\tuniform vec3 uColor1;\n\t\tuniform vec3 uColor2;\n\t\tvarying vec2 vUv;\n\t\t\n\t\t".concat("vec3 linearGradient( \r\n\tvec2 origin,\r\n\tvec2 target,\r\n\tvec3 color1,\r\n\tvec3 color2,\r\n\tfloat angle\r\n) {\r\n\r\n\tfloat toTarget = length( target );\r\n\tangle = radians( angle ) + atan( target.y, target.x );\r\n\r\n\tfloat progressX = cos( angle ) * toTarget;\r\n\tfloat progressY = sin( angle ) * toTarget;\r\n\tvec2 progress = vec2( progressX, progressY ) + origin;\r\n\r\n\treturn mix( color1, color2, smoothstep( 0.0, 1.0, progress.x ) );\r\n\t\r\n}","\n\t\t").concat(l,"\n\n\t\tvoid main() {\n\n\t\t\tvec2 origin = vec2( 0.5, 0.5 );\n\t\t\tvec2 target = vUv - origin;\n\t\t\tvec3 color = linearGradient( origin, target, uColor1, uColor2, uAngle );\n\t\t\t\n\t\t\tcolor = bayerMatrixDither( color );\n\n\t\t\tgl_FragColor = vec4( color, 1.0 );\n\t\t\t\n\t\t}")};var w={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\t\t}"};class x{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const A=new t.OrthographicCamera(-1,1,1,-1,0,1),_=new t.BufferGeometry;_.setAttribute("position",new t.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),_.setAttribute("uv",new t.Float32BufferAttribute([0,2,0,0,2,0],2));class k{constructor(e){this._mesh=new t.Mesh(_,e)}dispose(){this._mesh.geometry.dispose()}render(t){t.render(this._mesh,A)}get material(){return this._mesh.material}set material(t){this._mesh.material=t}}class C extends x{constructor(e,i){super(),this.textureID=void 0!==i?i:"tDiffuse",e instanceof t.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=t.UniformsUtils.clone(e.uniforms),this.material=new t.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new k(this.material)}render(t,e,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(e),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),this.fsQuad.render(t))}}class S extends x{constructor(t,e){super(),this.scene=t,this.camera=e,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(t,e,i){const r=t.getContext(),n=t.state;let o,s;n.buffers.color.setMask(!1),n.buffers.depth.setMask(!1),n.buffers.color.setLocked(!0),n.buffers.depth.setLocked(!0),this.inverse?(o=0,s=1):(o=1,s=0),n.buffers.stencil.setTest(!0),n.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),n.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),n.buffers.stencil.setClear(s),n.buffers.stencil.setLocked(!0),t.setRenderTarget(i),this.clear&&t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(e),this.clear&&t.clear(),t.render(this.scene,this.camera),n.buffers.color.setLocked(!1),n.buffers.depth.setLocked(!1),n.buffers.stencil.setLocked(!1),n.buffers.stencil.setFunc(r.EQUAL,1,4294967295),n.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),n.buffers.stencil.setLocked(!0)}}class T extends x{constructor(){super(),this.needsSwap=!1}render(t){t.state.buffers.stencil.setLocked(!1),t.state.buffers.stencil.setTest(!1)}}class E{constructor(e,i){if(this.renderer=e,void 0===i){const r={minFilter:t.LinearFilter,magFilter:t.LinearFilter,format:t.RGBAFormat},n=e.getSize(new t.Vector2);this._pixelRatio=e.getPixelRatio(),this._width=n.width,this._height=n.height,(i=new t.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,r)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=i.width,this._height=i.height;this.renderTarget1=i,this.renderTarget2=i.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===w&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===C&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new C(w),this.clock=new t.Clock}swapBuffers(){const t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t}addPass(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(t,e){this.passes.splice(e,0,t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(t){const e=this.passes.indexOf(t);-1!==e&&this.passes.splice(e,1)}isLastEnabledPass(t){for(let e=t+1;e<this.passes.length;e++)if(this.passes[e].enabled)return!1;return!0}render(t){void 0===t&&(t=this.clock.getDelta());const e=this.renderer.getRenderTarget();let i=!1;for(let e=0,r=this.passes.length;e<r;e++){const r=this.passes[e];if(!1!==r.enabled){if(r.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(e),r.render(this.renderer,this.writeBuffer,this.readBuffer,t,i),r.needsSwap){if(i){const e=this.renderer.getContext(),i=this.renderer.state.buffers.stencil;i.setFunc(e.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),i.setFunc(e.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==S&&(r instanceof S?i=!0:r instanceof T&&(i=!1))}}this.renderer.setRenderTarget(e)}reset(e){if(void 0===e){const i=this.renderer.getSize(new t.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=i.width,this._height=i.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(t,e){this._width=t,this._height=e;const i=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(i,r),this.renderTarget2.setSize(i,r);for(let t=0;t<this.passes.length;t++)this.passes[t].setSize(i,r)}setPixelRatio(t){this._pixelRatio=t,this.setSize(this._width,this._height)}}new t.OrthographicCamera(-1,1,1,-1,0,1);const M=new t.BufferGeometry;M.setAttribute("position",new t.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),M.setAttribute("uv",new t.Float32BufferAttribute([0,2,0,0,2,0],2));class z extends x{constructor(e,i,r,n,o){super(),this.scene=e,this.camera=i,this.overrideMaterial=r,this.clearColor=n,this.clearAlpha=void 0!==o?o:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new t.Color}render(t,e,i){const r=t.autoClear;let n,o;t.autoClear=!1,void 0!==this.overrideMaterial&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(t.getClearColor(this._oldClearColor),n=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:i),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor&&t.setClearColor(this._oldClearColor,n),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=o),t.autoClear=r}}function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $=function(){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.renderer,n=i.stage,o=i.useRenderTarget,s=void 0!==o&&o;P(this,e),s&&(this.renderTarget=new t.WebGLRenderTarget),this.composer=new E(r,this.renderTarget),this.composer.renderToScreen=!s,this.passes={},this.add("render",new z(n.scene,n.camera))}var i,r,n;return i=e,(r=[{key:"add",value:function(t,e){this.passes[t]=e,this.composer.addPass(e)}},{key:"remove",value:function(t){var e,i=this.passes[t];i&&(this.composer.removePass(i),null==i||null===(e=i.dispose)||void 0===e||e.call(i),delete this.passes[t])}},{key:"resize",value:function(t,e,i){this.composer.setSize(t,e),Object.values(this.passes).forEach((function(r){return null==r?void 0:r.setSize(t,e,i)}))}},{key:"tick",value:function(){this.composer.render()}},{key:"dispose",value:function(){Object.values(this.passes).forEach((function(t){var e;return null==t||null===(e=t.dispose)||void 0===e?void 0:e.call(t)})),Object.values(this).forEach((function(t){var e;return null==t||null===(e=t.dispose)||void 0===e?void 0:e.call(t)}))}}])&&O(i.prototype,r),n&&O(i,n),Object.defineProperty(i,"prototype",{writable:!1}),e}();
/**
 * lil-gui
 * https://lil-gui.georgealways.com
 * @version 0.11.0
 * @author George Michael Brower
 * @license MIT
 */
class D{constructor(t,e,i,r,n="div"){this.parent=t,this.object=e,this.property=i,this._disabled=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(r),this.$name=document.createElement("div"),this.$name.classList.add("name"),D.nextNameID=D.nextNameID||0,this.$name.id="lil-gui-name-"+ ++D.nextNameID,this.$widget=document.createElement(n),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(i)}name(t){return this._name=t,this.$name.innerHTML=t,this}onChange(t){return this._onChange=t,this}_callOnChange(){this.parent._callOnChange(this),void 0!==this._onChange&&this._onChange.call(this,this.getValue())}onFinishChange(t){return this.onChange(t)}reset(){return this.setValue(this.initialValue),this}enable(t=!0){return this.disable(!t)}disable(t=!0){return t===this._disabled||(this._disabled=t,this.domElement.classList.toggle("disabled",t),t?this.$disable.setAttribute("disabled","disabled"):this.$disable.removeAttribute("disabled")),this}options(t){const e=this.parent.add(this.object,this.property,t);return e.name(this._name),this.destroy(),e}min(t){return this}max(t){return this}step(t){return this}listen(t=!0){return this._listening=t,void 0!==this._listenCallbackID&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const t=this.getValue();t===this._listenValuePrev&&Object(t)!==t||this.updateDisplay(),this._listenValuePrev=t}getValue(){return this.object[this.property]}setValue(t){return this.object[this.property]=t,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(t){this.setValue(t)}save(){return this.getValue()}destroy(){this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class B extends D{constructor(t,e,i){super(t,e,i,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",(()=>{this.setValue(this.$input.checked)})),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function j(t){let e,i;return(e=t.match(/(#|0x)?([a-f0-9]{6})/i))?i=e[2]:(e=t.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?i=parseInt(e[1]).toString(16).padStart(2,0)+parseInt(e[2]).toString(16).padStart(2,0)+parseInt(e[3]).toString(16).padStart(2,0):(e=t.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(i=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),!!i&&"#"+i}const L={isPrimitive:!0,match:t=>"string"==typeof t,fromHexString:j,toHexString:j},R={isPrimitive:!0,match:t=>"number"==typeof t,fromHexString:t=>parseInt(t.substring(1),16),toHexString:t=>"#"+t.toString(16).padStart(6,0)},F={isPrimitive:!1,match:Array.isArray,fromHexString(t,e,i=1){const r=R.fromHexString(t);e[0]=(r>>16&255)/255*i,e[1]=(r>>8&255)/255*i,e[2]=(255&r)/255*i},toHexString:([t,e,i],r=1)=>R.toHexString(t*(r=255/r)<<16^e*r<<8^i*r<<0)},V={isPrimitive:!1,match:t=>Object(t)===t,fromHexString(t,e,i=1){const r=R.fromHexString(t);e.r=(r>>16&255)/255*i,e.g=(r>>8&255)/255*i,e.b=(255&r)/255*i},toHexString:({r:t,g:e,b:i},r=1)=>R.toHexString(t*(r=255/r)<<16^e*r<<8^i*r<<0)},U=[L,R,F,V];class I extends D{constructor(t,e,i,r){var n;super(t,e,i,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=(n=this.initialValue,U.find((t=>t.match(n)))),this._rgbScale=r,this._initialValueHexString=this.save(),this._textFocused=!1;const o=()=>{this._setValueFromHexString(this.$input.value)};this.$input.addEventListener("change",o),this.$input.addEventListener("input",o),this.$input.addEventListener("focus",(()=>{this.$display.classList.add("focus")})),this.$input.addEventListener("blur",(()=>{this.$display.classList.remove("focus")})),this.$text.addEventListener("input",(()=>{const t=j(this.$text.value);t&&this._setValueFromHexString(t)})),this.$text.addEventListener("focus",(()=>{this._textFocused=!0,this.$text.select()})),this.$text.addEventListener("blur",(()=>{this._textFocused=!1,this.updateDisplay()})),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(t){if(this._format.isPrimitive){const e=this._format.fromHexString(t);this.setValue(e)}else this._format.fromHexString(t,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(t){this._setValueFromHexString(t)}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class H extends D{constructor(t,e,i){super(t,e,i,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",(t=>{t.preventDefault(),this.getValue().call(this.object)})),this.$button.addEventListener("touchstart",(()=>{})),this.$disable=this.$button}}class Y extends D{constructor(t,e,i,r,n,o){super(t,e,i,"number"),this._initInput(),this.min(r),this.max(n);const s=void 0!==o;this.step(s?o:this._getImplicitStep(),s),this.updateDisplay()}min(t){return this._min=t,this._onUpdateMinMax(),this}max(t){return this._max=t,this._onUpdateMinMax(),this}step(t,e=!0){return this._step=t,this._stepExplicit=e,this}updateDisplay(){const t=this.getValue();if(this._hasSlider){const e=(t-this._min)/(this._max-this._min);this.$fill.style.setProperty("width",100*e+"%")}return this._inputFocused||(this.$input.value=t),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("inputmode","numeric"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$disable=this.$input;const t=t=>{const e=parseFloat(this.$input.value);isNaN(e)||(this._snapClampSetValue(e+t),this.$input.value=this.getValue())};this.$input.addEventListener("focus",(()=>{this._inputFocused=!0})),this.$input.addEventListener("input",(()=>{const t=parseFloat(this.$input.value);isNaN(t)||this.setValue(this._clamp(t))})),this.$input.addEventListener("blur",(()=>{this._inputFocused=!1,this.updateDisplay()})),this.$input.addEventListener("keydown",(e=>{"Enter"===e.code&&this.$input.blur(),"ArrowUp"===e.code&&(e.preventDefault(),t(this._step*this._arrowKeyMultiplier(e))),"ArrowDown"===e.code&&(e.preventDefault(),t(-1*this._step*this._arrowKeyMultiplier(e)))})),this.$input.addEventListener("wheel",(e=>{this._inputFocused&&(e.preventDefault(),t(this._normalizeMouseWheel(e)*this._step))}),{passive:!1})}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const t=t=>{const e=this.$slider.getBoundingClientRect();let i=(r=t,n=e.left,o=e.right,s=this._min,(r-n)/(o-n)*(this._max-s)+s);var r,n,o,s;this._snapClampSetValue(i)},e=e=>{t(e.clientX)},i=()=>{this._setActiveStyle(!1),window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",i)};this.$slider.addEventListener("mousedown",(r=>{t(r.clientX),this._setActiveStyle(!0),window.addEventListener("mousemove",e),window.addEventListener("mouseup",i)}));let r,n,o=!1;const s=e=>{if(o){const i=e.touches[0].clientX-r,l=e.touches[0].clientY-n;Math.abs(i)>Math.abs(l)?(e.preventDefault(),t(e.touches[0].clientX),this._setActiveStyle(!0),o=!1):(window.removeEventListener("touchmove",s),window.removeEventListener("touchend",a))}else e.preventDefault(),t(e.touches[0].clientX)},a=()=>{this._setActiveStyle(!1),window.removeEventListener("touchmove",s),window.removeEventListener("touchend",a)};this.$slider.addEventListener("touchstart",(e=>{e.touches.length>1||(this._hasScrollBar?(r=e.touches[0].clientX,n=e.touches[0].clientY,o=!0):(e.preventDefault(),t(e.touches[0].clientX),this._setActiveStyle(!0),o=!1),window.addEventListener("touchmove",s,{passive:!1}),window.addEventListener("touchend",a))})),this.$slider.addEventListener("wheel",(t=>{if(Math.abs(t.deltaX)<Math.abs(t.deltaY)&&this._hasScrollBar)return;t.preventDefault();const e=this._normalizeMouseWheel(t)*this._step;this._snapClampSetValue(this.getValue()+e)}),{passive:!1})}_setActiveStyle(t){this.$slider.classList.toggle("active",t),document.body.classList.toggle("lil-gui-slider-active",t)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(t){let{deltaX:e,deltaY:i}=t;return Math.floor(t.deltaY)!==t.deltaY&&t.wheelDelta&&(e=0,i=-t.wheelDelta/120),e+-i}_arrowKeyMultiplier(t){return this._stepExplicit?t.shiftKey?10:1:t.shiftKey?100:t.altKey?1:10}_snap(t){const e=Math.round(t/this._step)*this._step;return parseFloat(e.toPrecision(15))}_clamp(t){const e=this._hasMin?this._min:-1/0,i=this._hasMax?this._max:1/0;return Math.max(e,Math.min(i,t))}_snapClampSetValue(t){this.setValue(this._clamp(this._snap(t)))}get _hasScrollBar(){const t=this.parent.root.$children;return t.scrollHeight>t.clientHeight}get _hasMin(){return void 0!==this._min}get _hasMax(){return void 0!==this._max}}class X extends D{constructor(t,e,i,r){super(t,e,i,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(r)?r:Object.values(r),this._names=Array.isArray(r)?r:Object.keys(r),this._names.forEach((t=>{const e=document.createElement("option");e.innerHTML=t,this.$select.appendChild(e)})),this.$select.addEventListener("change",(()=>{this.setValue(this._values[this.$select.selectedIndex])})),this.$select.addEventListener("focus",(()=>{this.$display.classList.add("focus")})),this.$select.addEventListener("blur",(()=>{this.$display.classList.remove("focus")})),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){const t=this.getValue(),e=this._values.indexOf(t);return this.$select.selectedIndex=e,this.$display.innerHTML=-1===e?t:this._names[e],this}}class G extends D{constructor(t,e,i){super(t,e,i,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",(()=>{this.setValue(this.$input.value)})),this.$input.addEventListener("keydown",(t=>{"Enter"===t.code&&this.$input.blur()})),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}let N=!1;class W{constructor({parent:t,autoPlace:e=void 0===t,touchStyles:i=!0,container:r,injectStyles:n=!0,title:o="Controls",width:s}={}){if(this.parent=t,this.root=t?t.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",(()=>this.openAnimated(this._closed))),this.$title.addEventListener("keydown",(t=>{"Enter"!==t.code&&"Space"!==t.code||(t.preventDefault(),this.$title.click())})),this.$title.addEventListener("touchstart",(()=>{})),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(o),this.parent)return this.parent.children.push(this),this.parent.folders.push(this),void this.parent.$children.appendChild(this.domElement);this.domElement.classList.add("root"),!N&&n&&(function(t){const e=document.createElement("style");e.innerHTML='.lil-gui{font-family:var(--font-family);font-size:var(--font-size);line-height:1;font-weight:normal;font-style:normal;text-align:left;background-color:var(--background-color);color:var(--text-color);user-select:none;-webkit-user-select:none;touch-action:manipulation;--background-color:#1f1f1f;--text-color:#ebebeb;--title-background-color:#111;--title-text-color:#ebebeb;--widget-color:#424242;--hover-color:#4f4f4f;--focus-color:#595959;--number-color:#2cc9ff;--string-color:#a2db3c;--font-size:11px;--input-font-size:11px;--font-family:-apple-system,BlinkMacSystemFont,"Lucida Grande","Segoe UI",Roboto,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--font-family-mono:Menlo,Monaco,Consolas,"Droid Sans Mono",monospace,"Droid Sans Fallback";--padding:4px;--spacing:4px;--widget-height:20px;--name-width:45%;--slider-knob-width:2px;--slider-input-width:27%;--color-input-width:27%;--slider-input-min-width:45px;--color-input-min-width:45px;--folder-indent:7px;--widget-padding:0 0 0 3px;--widget-border-radius:2px;--checkbox-size:calc(.75*var(--widget-height));--scrollbar-width: 5px}.lil-gui,.lil-gui *{box-sizing:border-box;margin:0}.lil-gui.root{width:var(--width, 245px);display:flex;flex-direction:column}.lil-gui.root>.title{background:var(--title-background-color);color:var(--title-text-color)}.lil-gui.root>.children{overflow:auto}.lil-gui.root>.children::-webkit-scrollbar{width:var(--scrollbar-width);height:var(--scrollbar-width);background:var(--background-color)}.lil-gui.root>.children::-webkit-scrollbar-thumb{border-radius:var(--scrollbar-width);background:var(--focus-color)}.lil-gui .lil-gui{--background-color:inherit;--text-color:inherit;--title-background-color:inherit;--title-text-color:inherit;--widget-color:inherit;--hover-color:inherit;--focus-color:inherit;--number-color:inherit;--string-color:inherit;--font-size:inherit;--input-font-size:inherit;--font-family:inherit;--font-family-mono:inherit;--padding:inherit;--spacing:inherit;--widget-height:inherit;--name-width:inherit;--slider-knob-width:inherit;--slider-input-width:inherit;--color-input-width:inherit;--slider-input-min-width:inherit;--color-input-min-width:inherit;--folder-indent:inherit;--widget-padding:inherit;--widget-border-radius:inherit;--checkbox-size:inherit}@media(pointer: coarse){.lil-gui.allow-touch-styles{--widget-height: 28px;--padding: 6px;--spacing: 6px;--font-size: 13px;--input-font-size: 16px;--folder-indent: 10px;--widget-padding: 0 0 0 3px;--scrollbar-width: 7px;--slider-input-min-width: 50px;--color-input-min-width: 65px}}.lil-gui.force-touch-styles{--widget-height: 28px;--padding: 6px;--spacing: 6px;--font-size: 13px;--input-font-size: 16px;--folder-indent: 10px;--widget-padding: 0 0 0 3px;--scrollbar-width: 7px;--slider-input-min-width: 50px;--color-input-min-width: 65px}.lil-gui.autoPlace{max-height:100%;position:fixed;top:0;right:15px;z-index:1001}.lil-gui .controller{display:flex;align-items:center;padding:0 var(--padding);margin:var(--spacing) 0}.lil-gui .controller.disabled{opacity:.5}.lil-gui .controller.disabled,.lil-gui .controller.disabled *{pointer-events:none !important}.lil-gui .controller .name{min-width:var(--name-width);flex-shrink:0;white-space:pre;padding-right:var(--spacing);line-height:var(--widget-height)}.lil-gui .controller .widget{position:relative;display:flex;align-items:center;width:100%;min-height:var(--widget-height)}.lil-gui .controller.function .name{line-height:unset;padding:0}.lil-gui .controller.string input{color:var(--string-color)}.lil-gui .controller.boolean .widget{cursor:pointer}.lil-gui .controller.color .display{width:100%;height:var(--widget-height);border-radius:var(--widget-border-radius);position:relative}@media(hover: hover){.lil-gui .controller.color .display:hover:before{content:" ";display:block;position:absolute;border-radius:var(--widget-border-radius);border:1px solid #fff9;left:0;right:0;top:0;bottom:0}}.lil-gui .controller.color input[type=color]{opacity:0;width:100%;height:100%;cursor:pointer}.lil-gui .controller.color input[type=text]{margin-left:var(--spacing);font-family:var(--font-family-mono);min-width:var(--color-input-min-width);width:var(--color-input-width);flex-shrink:0}.lil-gui .controller.option select{opacity:0;position:absolute;width:100%;max-width:100%}.lil-gui .controller.option .display{position:relative;pointer-events:none;border-radius:var(--widget-border-radius);height:var(--widget-height);line-height:var(--widget-height);max-width:100%;overflow:hidden;word-break:break-all;padding-left:.55em;padding-right:1.75em;background:var(--widget-color)}@media(hover: hover){.lil-gui .controller.option .display.focus{background:var(--focus-color)}}.lil-gui .controller.option .display.active{background:var(--focus-color)}.lil-gui .controller.option .display:after{font-family:"lil-gui";content:"↕";position:absolute;top:0;right:0;bottom:0;padding-right:.375em}.lil-gui .controller.option .widget,.lil-gui .controller.option select{cursor:pointer}@media(hover: hover){.lil-gui .controller.option .widget:hover .display{background:var(--hover-color)}}.lil-gui .controller.number input{color:var(--number-color)}.lil-gui .controller.number.hasSlider input{margin-left:var(--spacing);width:var(--slider-input-width);min-width:var(--slider-input-min-width);flex-shrink:0}.lil-gui .controller.number .slider{width:100%;height:var(--widget-height);background-color:var(--widget-color);border-radius:var(--widget-border-radius);padding-right:var(--slider-knob-width);overflow:hidden;cursor:ew-resize;touch-action:pan-y}@media(hover: hover){.lil-gui .controller.number .slider:hover{background-color:var(--hover-color)}}.lil-gui .controller.number .slider.active{background-color:var(--focus-color)}.lil-gui .controller.number .slider.active .fill{opacity:.95}.lil-gui .controller.number .fill{height:100%;border-right:var(--slider-knob-width) solid var(--number-color);box-sizing:content-box}.lil-gui-slider-active .lil-gui{--hover-color: var(--widget-color)}.lil-gui-slider-active *{cursor:ew-resize !important}.lil-gui .title{--title-height: calc(var(--widget-height) + var(--spacing) * 1.25);height:var(--title-height);line-height:calc(var(--title-height) - 4px);font-weight:600;padding:0 var(--padding);-webkit-tap-highlight-color:transparent;cursor:pointer;outline:none;text-decoration-skip:objects}.lil-gui .title:before{font-family:"lil-gui";content:"▾";padding-right:2px;display:inline-block}.lil-gui .title:active{background:var(--title-background-color);opacity:.75}@media(hover: hover){.lil-gui .title:hover{background:var(--title-background-color);opacity:.85}.lil-gui .title:focus{text-decoration:underline var(--focus-color)}}.lil-gui.root>.title:focus{text-decoration:none !important}.lil-gui.closed>.title:before{content:"▸"}.lil-gui.closed>.children{transform:translateY(-7px);opacity:0}.lil-gui.closed:not(.transition)>.children{display:none}.lil-gui.transition>.children{transition-duration:300ms;transition-property:height,opacity,transform;transition-timing-function:cubic-bezier(0.215, 0.61, 0.355, 1);overflow:hidden;pointer-events:none}.lil-gui .children:empty:before{content:"Empty";padding:0 var(--padding);margin:var(--spacing) 0;display:block;height:var(--widget-height);font-style:italic;line-height:var(--widget-height);opacity:.5}.lil-gui.root>.children>.lil-gui>.title{border:0 solid var(--widget-color);border-width:1px 0;transition:border-color 300ms}.lil-gui.root>.children>.lil-gui.closed>.title{border-bottom-color:transparent}.lil-gui+.controller{border-top:1px solid var(--widget-color);margin-top:0;padding-top:var(--spacing)}.lil-gui .lil-gui .lil-gui>.title{border:none}.lil-gui .lil-gui .lil-gui>.children{border:none;margin-left:var(--folder-indent);border-left:2px solid var(--widget-color)}.lil-gui .lil-gui .controller{border:none}.lil-gui input{-webkit-tap-highlight-color:transparent;border:0;outline:none;font-family:var(--font-family);font-size:var(--input-font-size);border-radius:var(--widget-border-radius);height:var(--widget-height);background:var(--widget-color);color:var(--text-color);width:100%}@media(hover: hover){.lil-gui input:hover{background:var(--hover-color)}.lil-gui input:active{background:var(--focus-color)}}.lil-gui input[type=text]{padding:var(--widget-padding)}.lil-gui input[type=text]:focus{background:var(--focus-color)}.lil-gui input[type=checkbox]{appearance:none;-webkit-appearance:none;height:var(--checkbox-size);width:var(--checkbox-size);border-radius:var(--widget-border-radius);text-align:center}.lil-gui input[type=checkbox]:checked:before{font-family:"lil-gui";content:"✓";font-size:var(--checkbox-size);line-height:var(--checkbox-size)}@media(hover: hover){.lil-gui input[type=checkbox]:focus{box-shadow:inset 0 0 0 1px var(--focus-color)}}.lil-gui button{-webkit-tap-highlight-color:transparent;outline:none;cursor:pointer;font-family:var(--font-family);font-size:var(--font-size);color:var(--text-color);width:100%;height:var(--widget-height);text-transform:none;background:var(--widget-color);border-radius:var(--widget-border-radius);border:1px solid var(--widget-color);text-align:center;line-height:calc(var(--widget-height)*.725)}@media(hover: hover){.lil-gui button:hover{background:var(--hover-color);border-color:var(--hover-color)}.lil-gui button:focus{border-color:var(--focus-color)}}.lil-gui button:active{background:var(--focus-color)}@font-face{font-family:"lil-gui";src:url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZ5WI2hlYWQAAAMcAAAAJwAAADZfcj23aGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhjAGJgZWBgZ7RnFRdnVJELCRlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB76woyAHicY2BkYGAA4sklsQ/j+W2+MnAzpDBgAyEMYUCSg4EJxAEAvVwFCgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff")}';const i=document.querySelector("head link[rel=stylesheet], head style");i?document.head.insertBefore(e,i):document.head.appendChild(e)}(),N=!0),r?r.appendChild(this.domElement):e&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),i&&this.domElement.classList.add("allow-touch-styles"),s&&this.domElement.style.setProperty("--width",s+"px")}add(t,e,i,r,n){if(Object(i)===i)return new X(this,t,e,i);const o=t[e];switch(typeof o){case"number":return new Y(this,t,e,i,r,n);case"boolean":return new B(this,t,e);case"string":return new G(this,t,e);case"function":return new H(this,t,e)}console.error(`Failed to add controller for "${e}"`,o,t)}addColor(t,e,i=1){return new I(this,t,e,i)}addFolder(t){return new W({parent:this,title:t})}load(t,e=!0){if(!("controllers"in t))throw new Error('Invalid load object. Should contain a "controllers" key.');return this.controllers.forEach((e=>{e instanceof H||e._name in t.controllers&&e.load(t.controllers[e._name])})),e&&t.folders&&this.folders.forEach((e=>{e._title in t.folders&&e.load(t.folders[e._title])})),this}save(t=!0){const e={controllers:{},folders:{}};return this.controllers.forEach((t=>{if(!(t instanceof H)){if(t._name in e.controllers)throw new Error(`Cannot save GUI with duplicate property "${t._name}"`);e.controllers[t._name]=t.save()}})),t&&this.folders.forEach((t=>{if(t._title in e.folders)throw new Error(`Cannot save GUI with duplicate folder "${t._title}"`);e.folders[t._title]=t.save()})),e}open(t=!0){return this._closed=!t,this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}openAnimated(t=!0){return this._closed=!t,this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame((()=>{const e=this.$children.clientHeight;this.$children.style.height=e+"px",this.domElement.classList.add("transition");const i=t=>{t.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",i))};this.$children.addEventListener("transitionend",i);const r=t?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!t),requestAnimationFrame((()=>{this.$children.style.height=r+"px"}))})),this}title(t){return this._title=t,this.$title.innerHTML=t,this}reset(t=!0){return(t?this.controllersRecursive():this.controllers).forEach((t=>t.reset())),this}onChange(t){return this._onChange=t,this}_callOnChange(t){this.parent&&this.parent._callOnChange(t),void 0!==this._onChange&&this._onChange.call(this,{object:t.object,property:t.property,value:t.getValue(),controller:t})}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach((t=>t.destroy())),this._onResize&&window.removeEventListener("resize",this._onResize)}controllersRecursive(){let t=Array.from(this.controllers);return this.folders.forEach((e=>{t=t.concat(e.controllersRecursive())})),t}foldersRecursive(){let t=Array.from(this.folders);return this.folders.forEach((e=>{t=t.concat(e.foldersRecursive())})),t}}function Q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var J=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.target,r=void 0===i?window:i,n=e.width,o=void 0===n?window.innerWidth:n,s=e.height,a=void 0===s?window.innerHeight:s,l=e.margin,h=void 0===l?.02:l,c=e.marginTop,u=e.marginRight,d=e.marginBottom,f=e.marginLeft,p=e.enabled,v=void 0===p||p,m=e.debug,g=void 0!==m&&m,b=e.onChange;Q(this,t);var y=function(t){return"number"==typeof t&&t>=0?t:h};this.margin={top:y(c),right:y(u),bottom:y(d),left:y(f)},this.hitbox={top:this.margin.top,left:this.margin.left,width:o,height:a},this.resize(o,a),this.x=this.y=.5,this.target=r,this.onMouseMove=function(t){t.preventDefault&&t.preventDefault(),this.track(t.clientX,t.clientY)}.bind(this),this.onTouchMove=function(t){t.preventDefault(),this.onMouseMove(t.targetTouches[0])}.bind(this),this.onChange=b,g&&(this.onDebug=this.log),v&&this.enable()}var e,i,r;return e=t,(i=[{key:"enable",value:function(){this._enabled||(this.target.addEventListener("touchmove",this.onTouchMove),this.target.addEventListener("mousemove",this.onMouseMove),this._enabled=!0)}},{key:"disable",value:function(){this._enabled&&(this.target.removeEventListener("touchmove",this.onTouchMove),this.target.removeEventListener("mousemove",this.onMouseMove),this._enabled=!1)}},{key:"dispose",value:function(){this.disable()}},{key:"track",value:function(t,e){var i,r,n;if(this.clientX!==t){this.clientX=t;var o=this.normalizeX;this.x!==o&&(this.x=o,n=!0)}if(this.clientY!==e){this.clientY=e;var s=this.normalizeY;this.y!==s&&(this.y=s,n=!0)}n&&(null===(i=this.onChange)||void 0===i||i.call(this),null===(r=this.onDebug)||void 0===r||r.call(this))}},{key:"resize",value:function(t,e){var i=this.margin.left*t,r=this.margin.right*t;this.hitbox.width=t-i-r,this.offsetX=i;var n=this.margin.top*e,o=this.margin.bottom*e;this.hitbox.height=e-n-o,this.offsetY=n}},{key:"log",value:function(){var t=this.x,e=this.y,i=this.reverseX,r=this.reverseY,n=this.polarizeX,o=this.polarizeY,s=this.reversePolarizeX,a=this.reversePolarizeY,l=this.centerX,h=this.centerY,c=this.reverseCenterX,u=this.reverseCenterY;console.log({x:t,y:e,reverseX:i,reverseY:r,polarizeX:n,polarizeY:o,reversePolarizeX:s,reversePolarizeY:a,centerX:l,centerY:h,reverseCenterX:c,reverseCenterY:u})}},{key:"normalizeX",get:function(){return t.normalize(this.clientX-this.offsetX,this.hitbox.width)}},{key:"normalizeY",get:function(){return t.normalize(this.clientY-this.offsetY,this.hitbox.height)}},{key:"reverseX",get:function(){return t.reverse(this.x)}},{key:"reverseY",get:function(){return t.reverse(this.y)}},{key:"polarizeX",get:function(){return t.polarize(this.x)}},{key:"polarizeY",get:function(){return t.polarize(this.y)}},{key:"reversePolarizeX",get:function(){return t.reversePolarize(this.x)}},{key:"reversePolarizeY",get:function(){return t.reversePolarize(this.y)}},{key:"centerX",get:function(){return t.center(this.x)}},{key:"centerY",get:function(){return t.center(this.y)}},{key:"reverseCenterX",get:function(){return t.reverseCenter(this.x)}},{key:"reverseCenterY",get:function(){return t.reverseCenter(this.y)}}])&&K(e.prototype,i),r&&K(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function q(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}J.clamp=function(t){return t>1?1:t<0?0:t},J.normalize=function(t,e){return J.clamp(t/e)},J.reverse=function(t){return 1-t},J.polarize=function(t){return 2*t-1},J.reversePolarize=function(t){return 1-2*t},J.center=function(t){return 1-2*Math.abs(t-.5)},J.reverseCenter=function(t){return 2*Math.abs(t-.5)};var tt=function(){function e(i){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.lookAt,o=void 0===n?{x:0,y:0,z:0}:n,s=r.bounds,a=void 0===s?{x:5,y:5,z:0}:s,l=r.speed,h=void 0===l?.002:l;Z(this,e),this.camera=i,this.lookAt=new t.Vector3(o.x,o.y,o.z),this.bounds=new t.Vector3(a.x,a.y,a.z),this.speed=h,this.target=new t.Vector3,this.origin=(new t.Vector3).copy(i.position)}var i,r,n;return i=e,r=[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.camera.position.set(t,e,i),this}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.target.x=this.origin.x+this.bounds.x*t,this.target.y=this.origin.y+this.bounds.y*e,this.target.z=this.origin.z+this.bounds.z*i,this}},{key:"tick",value:function(t){return this.camera.position.lerp(this.target,this.speed*t),this.camera.lookAt(this.lookAt),this}}],r&&q(i.prototype,r),n&&q(i,n),Object.defineProperty(i,"prototype",{writable:!1}),e}();function et(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function it(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var rt=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.camera,n=void 0===r||r,o=i.tracker,s=void 0===o||o;et(this,t),this.sketch=e,s&&this.initTracker(),n&&this.initCamera(),e.settings.gui&&this.initGUI()}var e,i,r;return e=t,(i=[{key:"initTracker",value:function(){this.tracker=new J}},{key:"initCamera",value:function(){var t=this.sketch,e=t.settings,i=t.stage,r=e.cameraLookAt,n=e.cameraBounds,o=e.cameraLerpSpeed,s=e.cameraIntro;this.cameraLerper=new tt(i.camera,{lookAt:r,bounds:n,speed:o,intro:s})}},{key:"initGUI",value:function(){this.gui=new W}},{key:"resize",value:function(t,e){var i;null===(i=this.tracker)||void 0===i||i.resize(t,e)}},{key:"tick",value:function(t){this.tracker&&this.cameraLerper&&(this.cameraLerper.update(this.tracker.reversePolarizeX,this.tracker.y),this.cameraLerper.tick(t))}}])&&it(e.prototype,i),r&&it(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function nt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ot(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}rt.GUI=W,rt.GUI_MINIFY_BREAKPOINT=1e3,rt.lerp=t.MathUtils.lerp;var st=function(){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.background,n=i.camera,o=void 0===n?new t.PerspectiveCamera:n,s=i.cameraNear,a=void 0===s?.1:s,l=i.cameraFar,h=void 0===l?1e3:l,c=i.cameraFov,u=void 0===c?50:c,d=i.cameraStart,f=void 0===d?{x:10,y:10,z:10}:d,p=i.cameraLookAt,v=void 0===p?{x:0,y:0,z:0}:p;nt(this,e),this.scene=new t.Scene,r&&(this.scene.background=r),o.near=a,o.far=h,o.fov=u,o.position.set(f.x,f.y,f.z),o.lookAt(v.x,v.y,v.z),this.camera=o}var i,r,n;return i=e,r=[{key:"add",value:function(t){this.scene.add(t)}},{key:"remove",value:function(t){this.scene.remove(t)}},{key:"resize",value:function(t,e){this.camera.aspect=t/e,this.camera.updateProjectionMatrix()}},{key:"getVisibleHeight",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.camera.position.z,i=t<e?-e:e;t+=i;var r=this.camera.fov*Math.PI/180;return 2*Math.tan(r/2)*Math.abs(t)}},{key:"getVisibleWidth",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getVisibleHeight(t)*this.camera.aspect}}],r&&ot(i.prototype,r),n&&ot(i,n),Object.defineProperty(i,"prototype",{writable:!1}),e}();function at(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function lt(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?at(Object(i),!0).forEach((function(e){ht(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):at(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function ht(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ct(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ut(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var dt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.defaults,r=void 0===i?{}:i,n=t.settings,o=void 0===n?{}:n,l=t.stage,h=t.background,c=t.camera,u=t.random;ct(this,e),o=lt(lt({},r),o),this.settings=o,l||(l=new st(lt(lt({},o),{},{background:h,camera:c}))),this.stage=l;var d=o.sketchpad||new s;this.sketchpad=d,this.effects=new $({renderer:d.renderer,stage:l}),this.random=u||o.random?new a:null,!h&&o.background&&this.buildBackground()}var i,r,n;return i=e,r=[{key:"buildBackground",value:function(){var e=this.settings.background,i=e instanceof t.Color?e:("string"==typeof e||"number"==typeof e)&&new t.Color(e);if(i)return this.stage.background=i;e.color1&&e.color2&&(this.background=new y(e),this.add(this.background))}},{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rt;this.build(),t&&(this.controls=new t(this))}},{key:"build",value:function(){}},{key:"dispose",value:function(){this.stage.dispose(),this.effects.dispose()}},{key:"resize",value:function(t,e,i){var r,n;this.stage.resize(t,e),null===(r=this.controls)||void 0===r||r.resize(t,e),null===(n=this.effects)||void 0===n||n.resize(t,e,i)}},{key:"tick",value:function(t,e){var i;null===(i=this.controls)||void 0===i||i.tick(t,e),this.effects.tick(t,e)}},{key:"add",value:function(t){this.stage.add(t)}},{key:"remove",value:function(t){this.stage.remove(t)}}],r&&ut(i.prototype,r),n&&ut(i,n),Object.defineProperty(i,"prototype",{writable:!1}),e}();const ft={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new t.Color(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};class pt extends x{constructor(e,i,r,n){super(),this.strength=void 0!==i?i:1,this.radius=r,this.threshold=n,this.resolution=void 0!==e?new t.Vector2(e.x,e.y):new t.Vector2(256,256),this.clearColor=new t.Color(0,0,0);const o={minFilter:t.LinearFilter,magFilter:t.LinearFilter,format:t.RGBAFormat};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);this.renderTargetBright=new t.WebGLRenderTarget(s,a,o),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let e=0;e<this.nMips;e++){const i=new t.WebGLRenderTarget(s,a,o);i.texture.name="UnrealBloomPass.h"+e,i.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(i);const r=new t.WebGLRenderTarget(s,a,o);r.texture.name="UnrealBloomPass.v"+e,r.texture.generateMipmaps=!1,this.renderTargetsVertical.push(r),s=Math.round(s/2),a=Math.round(a/2)}void 0===ft&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const l=ft;this.highPassUniforms=t.UniformsUtils.clone(l.uniforms),this.highPassUniforms.luminosityThreshold.value=n,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new t.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const h=[3,5,7,9,11];s=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);for(let e=0;e<this.nMips;e++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(h[e])),this.separableBlurMaterials[e].uniforms.texSize.value=new t.Vector2(s,a),s=Math.round(s/2),a=Math.round(a/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=i,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new t.Vector3(1,1,1),new t.Vector3(1,1,1),new t.Vector3(1,1,1),new t.Vector3(1,1,1),new t.Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===w&&console.error("THREE.UnrealBloomPass relies on CopyShader");const c=w;this.copyUniforms=t.UniformsUtils.clone(c.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new t.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,blending:t.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new t.Color,this.oldClearAlpha=1,this.basic=new t.MeshBasicMaterial,this.fsQuad=new k(null)}dispose(){for(let t=0;t<this.renderTargetsHorizontal.length;t++)this.renderTargetsHorizontal[t].dispose();for(let t=0;t<this.renderTargetsVertical.length;t++)this.renderTargetsVertical[t].dispose();this.renderTargetBright.dispose()}setSize(e,i){let r=Math.round(e/2),n=Math.round(i/2);this.renderTargetBright.setSize(r,n);for(let e=0;e<this.nMips;e++)this.renderTargetsHorizontal[e].setSize(r,n),this.renderTargetsVertical[e].setSize(r,n),this.separableBlurMaterials[e].uniforms.texSize.value=new t.Vector2(r,n),r=Math.round(r/2),n=Math.round(n/2)}render(t,e,i,r,n){t.getClearColor(this._oldClearColor),this.oldClearAlpha=t.getClearAlpha();const o=t.autoClear;t.autoClear=!1,t.setClearColor(this.clearColor,0),n&&t.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=i.texture,t.setRenderTarget(null),t.clear(),this.fsQuad.render(t)),this.highPassUniforms.tDiffuse.value=i.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,t.setRenderTarget(this.renderTargetBright),t.clear(),this.fsQuad.render(t);let s=this.renderTargetBright;for(let e=0;e<this.nMips;e++)this.fsQuad.material=this.separableBlurMaterials[e],this.separableBlurMaterials[e].uniforms.colorTexture.value=s.texture,this.separableBlurMaterials[e].uniforms.direction.value=pt.BlurDirectionX,t.setRenderTarget(this.renderTargetsHorizontal[e]),t.clear(),this.fsQuad.render(t),this.separableBlurMaterials[e].uniforms.colorTexture.value=this.renderTargetsHorizontal[e].texture,this.separableBlurMaterials[e].uniforms.direction.value=pt.BlurDirectionY,t.setRenderTarget(this.renderTargetsVertical[e]),t.clear(),this.fsQuad.render(t),s=this.renderTargetsVertical[e];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,t.setRenderTarget(this.renderTargetsHorizontal[0]),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,n&&t.state.buffers.stencil.setTest(!0),this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(i),this.fsQuad.render(t)),t.setClearColor(this._oldClearColor,this.oldClearAlpha),t.autoClear=o}getSeperableBlurMaterial(e){return new t.ShaderMaterial({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new t.Vector2(.5,.5)},direction:{value:new t.Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat fSigma = float(SIGMA);\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}getCompositeMaterial(e){return new t.ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform sampler2D dirtTexture;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}function vt(t){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vt(t)}function mt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gt(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bt(t,e){return bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},bt(t,e)}function yt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=xt(t);if(e){var n=xt(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return wt(this,i)}}function wt(t,e){if(e&&("object"===vt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function xt(t){return xt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},xt(t)}pt.BlurDirectionX=new t.Vector2(1,0),pt.BlurDirectionY=new t.Vector2(0,1);var At=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&bt(t,e)}(s,e);var i,r,n,o=yt(s);function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.strength,r=void 0===i?.6:i,n=e.radius,a=void 0===n?1:n,l=e.threshold,h=void 0===l?.3:l;return mt(this,s),o.call(this,new t.Vector2,r,a,h)}return i=s,(r=[{key:"getCompositeMaterial",value:function(e){return new t.ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform sampler2D dirtTexture;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\t".concat(l,"\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 color = bloomStrength * ( \n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv)\n\t\t\t\t\t);\n\n\t\t\t\t\tcolor.rgb = bayerMatrixDither( color.rgb );\n\n\t\t\t\t\tgl_FragColor = color;\n\t\t\t\t}")})}}])&&gt(i.prototype,r),n&&gt(i,n),Object.defineProperty(i,"prototype",{writable:!1}),s}(pt);Math.PI;const _t="//\tSimplex 3D Noise \n//\tby Ian McEwan, Ashima Arts\n//\nvec4 permute( vec4 x ){ return mod( ( ( x * 34.0 ) + 1.0 ) * x, 289.0 ); }\nvec4 taylorInvSqrt( vec4 r ){ return 1.79284291400159 - 0.85373472095314 * r; }\n\nfloat simplex3D( float vx, float vy, float vz ) {\n\n\tvec3 v = vec3( vx, vy, vz );\n\t\n\tconst vec2 C = vec2( 1.0/6.0, 1.0/3.0   );\n\tconst vec4 D = vec4( 0.0, 0.5, 1.0, 2.0 );\n\n\t// First corner\n\tvec3 i  = floor( v + dot( v, C.yyy ) );\n\tvec3 x0 =   v - i + dot( i, C.xxx ) ;\n\n\t// Other corners\n\tvec3 g = step( x0.yzx, x0.xyz );\n\tvec3 l = 1.0 - g;\n\tvec3 i1 = min(  g.xyz, l.zxy );\n\tvec3 i2 = max(  g.xyz, l.zxy );\n\n\t// x0 = x0 - 0. + 0.0 * C \n\tvec3 x1 = x0 - i1 + 1.0 * C.xxx;\n\tvec3 x2 = x0 - i2 + 2.0 * C.xxx;\n\tvec3 x3 = x0 - 1. + 3.0 * C.xxx;\n\n\t// Permutations\n\ti = mod( i, 289.0 ); \n\tvec4 p = permute( permute( permute(\n\t\t\t i.z + vec4( 0.0, i1.z, i2.z, 1.0 ) )\n\t\t   + i.y + vec4( 0.0, i1.y, i2.y, 1.0 ) ) \n\t\t   + i.x + vec4( 0.0, i1.x, i2.x, 1.0 ) );\n\n\t// Gradients\n\t// ( N*N points uniformly over a square, mapped onto an octahedron.)\n  \tfloat n_ = 1.0/7.0; // N=7\n  \tvec3  ns = n_ * D.wyz - D.xzx;\n\n  \tvec4 j = p - 49.0 * floor( p * ns.z *ns.z ); //  mod( p,N*N)\n\n  \tvec4 x_ = floor( j * ns.z );\n  \tvec4 y_ = floor( j - 7.0 * x_ ); // mod( j,N)\n\n  \tvec4 x = x_ *ns.x + ns.yyyy;\n  \tvec4 y = y_ *ns.x + ns.yyyy;\n  \tvec4 h = 1.0 - abs( x ) - abs( y );\n\n  \tvec4 b0 = vec4( x.xy, y.xy );\n  \tvec4 b1 = vec4( x.zw, y.zw );\n\n  \tvec4 s0 = floor( b0 )*2.0 + 1.0;\n  \tvec4 s1 = floor( b1 )*2.0 + 1.0;\n  \tvec4 sh = -step( h, vec4( 0.0 ) );\n\n  \tvec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  \tvec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  \tvec3 p0 = vec3( a0.xy,h.x );\n  \tvec3 p1 = vec3( a0.zw,h.y );\n  \tvec3 p2 = vec3( a1.xy,h.z );\n  \tvec3 p3 = vec3( a1.zw,h.w );\n\n\t// Normalise gradients\n  \tvec4 norm = taylorInvSqrt( \n\t\tvec4( dot( p0, p0 ), dot( p1, p1 ), dot( p2, p2 ), dot( p3, p3 ) )\n\t);\n  \tp0 *= norm.x;\n  \tp1 *= norm.y;\n  \tp2 *= norm.z;\n  \tp3 *= norm.w;\n\n\t// Mix final noise value\n  \tvec4 m = max( \n\t\t0.6 - vec4( dot( x0, x0 ), dot( x1, x1 ), dot( x2, x2 ), dot( x3, x3 ) ), \n\t\t0.0\n\t);\n  \tm = m * m;\n  \treturn 42.0 * dot( \n\t\tm*m,\n\t\tvec4( dot( p0,x0 ), dot( p1,x1 ), dot( p2,x2 ), dot( p3,x3 ) )\n\t);\n\n}";new t.Vector2(1/1024,1/512);var kt=.4*.1,Ct={title:"Blockflow",background:{color1:23152,color2:34136},tile:{countX:40,countZ:40,width:.4,height:.05,depth:.4,margin:{x:kt,y:0,z:kt}},bounds:{x:18,y:18,z:18},material:{color:65390,opacity:.4,transparent:!0},cameraStart:{x:10,y:10,z:10},cameraBounds:{x:10,y:20,z:0},bloom:{strength:.3,radius:.5,threshold:.4},speed:{value:4e-4},gui:!0,debug:!0};function St(t){return St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},St(t)}function Tt(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Et(){return Et="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=Mt(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(arguments.length<3?t:i):n.value}},Et.apply(this,arguments)}function Mt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$t(t)););return t}function zt(t,e){return zt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},zt(t,e)}function Pt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=$t(t);if(e){var n=$t(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return Ot(this,i)}}function Ot(t,e){if(e&&("object"===St(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function $t(t){return $t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},$t(t)}var Dt=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&zt(t,e)}(s,e);var i,r,n,o=Pt(s);function s(e){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(i=o.call(this,e)).raycaster=new t.Raycaster,i.hitbox=new t.Mesh(new t.PlaneGeometry(50,50),new t.MeshBasicMaterial({color:"red",opacity:.25,transparent:!0})),i.hitbox.rotateX(-Math.PI/2),e.add(i.hitbox);return i.cursor=new t.Mesh(new t.BoxGeometry(1,1,1),new t.MeshBasicMaterial({color:"red",wireframe:!0})),e.add(i.cursor),i.cursor.tracker=new t.Vector3,i.hitbox.visible=!1,i.cursor.visible=!1,i.cameraLerper.speed=.001,i}return i=s,r=[{key:"initGUI",value:function(){var t=this.sketch,e=new rt.GUI({title:t.settings.title}),i=e.addFolder("Colors");i.addColor(t.background,"color1").name("background1"),i.addColor(t.background,"color2").name("background2"),i.addColor(t.grid.material,"color");var r=e.addFolder("Bloom");r.add(t.effects.passes.bloom,"strength",0,1),r.add(t.effects.passes.bloom,"radius",0,1),r.add(t.effects.passes.bloom,"threshold",0,1),window.innerWidth<rt.GUI_MINIFY_BREAKPOINT&&e.close(),this.gui=e}},{key:"tick",value:function(t){Et($t(s.prototype),"tick",this).call(this,t);var e=this.tracker,i=this.cursor,r=this.hitbox,n=this.raycaster,o=this.sketch.stage.camera;i.tracker.set(e.polarizeX,e.reversePolarizeY),this.raycaster.setFromCamera(i.tracker,o);var a=n.intersectObjects([r])[0];a&&i.position.copy(a.point)}}],r&&Tt(i.prototype,r),n&&Tt(i,n),Object.defineProperty(i,"prototype",{writable:!1}),s}(rt);function Bt(t){return Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bt(t)}function jt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lt(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Rt(){return Rt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=Ft(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(arguments.length<3?t:i):n.value}},Rt.apply(this,arguments)}function Ft(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ht(t)););return t}function Vt(t,e){return Vt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Vt(t,e)}function Ut(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=Ht(t);if(e){var n=Ht(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return It(this,i)}}function It(t,e){if(e&&("object"===Bt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ht(t){return Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ht(t)}var Yt=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&Vt(t,e)}(s,e);var i,r,n,o=Ut(s);function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return jt(this,s),o.call(this,{defaults:Ct,settings:t})}return i=s,r=[{key:"init",value:function(){this.build(),this.effects.add("bloom",new At(this.settings.bloom)),this.controls=new Dt(this),this.shader.uniforms.uCursor.value=this.controls.cursor.position}},{key:"build",value:function(){var e=this.settings,i=e.tile,r=i.countX*i.countZ,n=i.width+i.margin.x,o=i.depth+i.margin.z,s=n*i.countX-i.margin.x,a=o*i.countZ-i.margin.z,l=-(s-i.width)/2,h=-i.height,c=-(a-i.depth)/2;e.debug&&console.log({instances:r});for(var u=new t.BoxGeometry(i.width,i.height,i.depth),d=new t.EdgesGeometry(u),f=new Float32Array(d.attributes.position.array),p=3*r,v=new Float32Array(p),m=0,g=0,b=0;b<p;b+=3)v[b]=l+m*n,v[b+1]=h,v[b+2]=c+g*o,0==(m=(m+1)%i.countX)&&g++;var y=new t.InstancedBufferGeometry;y.instanceCount=r,y.setAttribute("position",new t.Float32BufferAttribute(f,3)),y.setAttribute("aOffset",new t.InstancedBufferAttribute(v,3));var w=new t.LineBasicMaterial(e.material);w.onBeforeCompile=this.editShader.bind(this),this.shader={uniforms:{uCursor:{value:null},uTime:{value:0}}},this.grid=new t.LineSegments(y,w),this.add(this.grid)}},{key:"editShader",value:function(t){Object.assign(t.uniforms,this.shader.uniforms);var e="#include <common>",i="\n\t\t\tattribute vec3 aOffset;\n\t\t\tuniform float uTime;\n\t\t\tuniform vec3 uCursor;\n\t\t\t".concat(_t,"\n\t\t\tfloat integralSmoothstep( float x, float T ) {\n    \t\t\tif( x>T ) return x - T/2.0;\n    \t\t\treturn x*x*x*(1.0-x*0.5/T)/T/T;\n\t\t\t}\n\t\t");t.vertexShader=t.vertexShader.replace(e,e+i);var r="#include <begin_vertex>";t.vertexShader=t.vertexShader.replace(r,r+"\n\t\t\n\t\t\ttransformed += aOffset;\n\n\t\t\tfloat distanceToCursor = length( uCursor - aOffset );\n\t\t\tfloat force = - 6.18 / distanceToCursor;\n\t\t\tfloat yScale = position.y * clamp(\n\t\t\t\tsimplex3D( \n\t\t\t\t\taOffset.x * 0.015, \n\t\t\t\t\tdistanceToCursor * 0.1 - uTime,\n\t\t\t\t\taOffset.z * 0.015\n\t\t\t\t) * force * 40.0, \n\t\t\t\t-30.0,  \n\t\t\t\t30.0\n\t\t\t) * 40.0;\n\n\t\t\ttransformed.y *= yScale;\n\t\t\t\n\t\t"),this.shader=t}},{key:"tick",value:function(t,e){this.shader.uniforms.uTime.value=e*this.settings.speed.value,Rt(Ht(s.prototype),"tick",this).call(this,t)}}],r&&Lt(i.prototype,r),n&&Lt(i,n),Object.defineProperty(i,"prototype",{writable:!1}),s}(dt),Xt=new s({container:"background"}),Gt={sketchpad:Xt},Nt=function(){return new Yt(Gt)}();Xt.init(Nt)})();