(()=>{"use strict";const t=THREE;function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var r=n((function e(n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r||(r=h.getTextureSize(n.length));var o=h.createDataTexture(r);return o.needsUpdate=!0,h.FloatPack.pack(n,o.image.data),new t.Uniform(o)}));var o={glsl:"\nvec4 packFloat( float value ) {\n\n\tif ( value == 0.0 ) return vec4( 0.0, 0.0, 0.0, 0.0 );\n\n\tfloat mag = abs( value );\n\t\n\tfloat exponent = floor( log2( mag ) );\n\texponent += float( exp2( exponent ) <= mag / 2.0 );\n\texponent -= float( exp2( exponent ) > mag );\n\n\tfloat mantissa = ( exponent > 100.0 )\n\t\t? mag / 1024.0 / exp2( exponent - 10.0 ) - 1.0\n\t\t: mag / float( exp2( exponent ) ) - 1.0;\n\n\tfloat r = exponent + 127.0;\n\tmantissa *= 256.0;\n\n\tfloat g = floor( mantissa );\n\tmantissa -= g;\n\tmantissa *= 256.0;\n\n\tfloat b = floor( mantissa );\n\tmantissa -= b;\n\tmantissa *= 128.0;\n\n\tfloat a = floor( mantissa ) * 2.0 + float( value < 0.0 );\n\n\treturn vec4( r, g, b, a ) / 255.0;\n\n}\n\nfloat unpackFloat( vec4 value ) {\n\n\tfloat r = floor( value.r * 255.0 + 0.5 );\n\tfloat g = floor( value.g * 255.0 + 0.5 );\n\tfloat b = floor( value.b * 255.0 + 0.5 );\n\tfloat a = floor( value.a * 255.0 + 0.5 );\n\n\tfloat exponent = r - 127.0;\n\tfloat sign = 1.0 - mod( a, 2.0 ) * 2.0;\n\tfloat mantissa = float( r > 0.0 ) + g / 256.0 + b / 65536.0\n\t\t+ floor( a / 2.0 ) / 8388608.0;\n\treturn sign * mantissa * exp2( exponent );\n\n}",pack:function(t,e){var n,r,o,i,a,s,l;e||(e=new Uint8Array(4*t.length));for(var c=0,u=0,f=t.length;c<f;c++)0!==(n=t[c])&&(r=Math.abs(n),o=Math.floor(Math.log2(r)),o+=(i=Math.pow(2,o))<=r/2,a=(o-=i>r)>100?r/1024/Math.pow(2,o-10)-1:r/i-1,e[u]=o+127,a*=256,s=Math.floor(a),e[u+1]=s,a=256*(a-s),l=Math.floor(a),e[u+2]=l,a=128*(a-l),e[u+3]=2*Math.floor(a)+(n<0)),u+=4;return e},unpack:function(t,e){var n,r,o,i,a,s;e||(e=new Float32Array(t.length/4));for(var l=0,c=0,u=t.length;l<u;l+=4)n=t[l],r=t[l+1],o=t[l+2],a=n-127,s=(1-(i=t[l+3])%2*2)*((n>0)+r/256+o/65536+Math.floor(i/2)/8388608)*Math.pow(2,a),e[c]=s,c++}};function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.data,o=n.defaultValue,a=n.textureSize,s=n.length,l=void 0===s?65536:s,c=n.name,u=void 0===c?"data":c,f=n.prefix,d=void 0===f?"GPGPU_":f,p=n.shader,m=void 0===p?e.fragmentShader:p,v=n.uniforms,y=void 0===v?{}:v;if(i(this,e),!h.renderer)throw new Error("Use GPUVariable.init( renderer ) before instancing.");r?l=r.length:a&&(l=a*a),a||(a=h.getTextureSize(l)),this.textureSize=a,this.rt1=h.createRenderTarget(a),this.rt2=h.createRenderTarget(a),this.renderTarget=this.rt1,this.dataTexture=h.createDataTexture(a),this.dataTexture.needsUpdate=!0,r?this.write(r):(r=this.createDataArray(o),o&&this.write(r)),this.output=new t.Uniform(this.dataTexture),this.name=d?d+u:u,this.uniforms=y,this.uniforms[this.name]=this.output,this.material=new t.ShaderMaterial({uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:m});var b=a.toFixed(1);this.material.defines.resolution="vec2( ".concat(b,", ").concat(b," )")}var n,r,s;return n=e,(r=[{key:"update",value:function(){this.renderTarget=this.renderTarget===this.rt1?this.rt2:this.rt1,h.render(this.material,this.renderTarget),this.output.value=this.renderTarget.texture}},{key:"dispose",value:function(){this.rt1.dispose(),this.rt2.dispose(),this.dataTexture.dispose(),this.material.dispose()}},{key:"createDataArray",value:function(t){var e=new Float32Array(this.textureSize*this.textureSize);return t&&e.fill(t),e}},{key:"read",value:function(){h.renderer.readRenderTargetPixels(this.renderTarget,0,0,this.textureSize,this.textureSize,this.buffer);var t=this.createDataArray();return o.unpack(this.buffer,t),t}},{key:"write",value:function(t){o.pack(t,this.buffer)}},{key:"buffer",get:function(){return this.dataTexture.image.data}}])&&a(n.prototype,r),s&&a(n,s),Object.defineProperty(n,"prototype",{writable:!1}),e}();function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}s.vertexShader="\n    void main() {\n\n        gl_Position = vec4( position, 1.0 );\n\n    }\n",s.fragmentShader="\n    uniform sampler2D GPGPU_data;\n\n    ".concat(o.glsl,"\n\n    void main() {\n        \n        vec2 uv = gl_FragCoord.xy / resolution.xy;\n        float data = unpackFloat( texture2D( GPGPU_data, uv ) );\n\n        // Modify data...\n\n        gl_FragColor = packFloat( data );\n\n    }\n");var h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._textureSize=t.getTextureSize(e),this.variables={}}var e,n,o;return e=t,n=[{key:"addVariable",value:function(t,e){var n=new s(c(c({},e),{},{name:t,textureSize:this._textureSize}));this.variables[t]=n,this[t]=n.output}},{key:"addConstant",value:function(t,e){this[t]=new r(e,this._textureSize)}},{key:"assign",value:function(t,e){var n=this.variables[t],r=this.variables[e];n.uniforms[r.name]=r.output}},{key:"tick",value:function(){Object.values(this.variables).forEach((function(t){return t.update()}))}},{key:"textureSize",get:function(){return this._textureSize}}],n&&f(e.prototype,n),o&&f(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}h.init=function(e){if(!h.renderer){h.renderer=e;h.isSupported=!0,h.renderer.capabilities.maxVertexTextures||(console.warn("No support for vertex textures."),h.isSupported=!1),h.isSupported||window.alert("Incompatible hardware."),h.isSupported&&(h.renderer=e,h.scene=new t.Scene,h.camera=new t.Camera,h.mesh=new t.Mesh(new t.PlaneGeometry(2,2)),h.scene.add(h.mesh))}},h.getTextureSize=function(t){if(isNaN(t)||!isFinite(t)||!Number.isInteger(t)||t<1)throw new RangeError("Parameter must be an int > 0 ");for(var e=1,n=2;n*n<t;)n=Math.pow(2,e),e++;return n},h.createDataTexture=function(e){return new t.DataTexture(new Uint8Array(e*e*4),e,e,t.RGBAFormat,t.UnsignedByteType)},h.createRenderTarget=function(e){return new t.WebGLRenderTarget(e,e,{wrapS:t.ClampToEdgeWrapping,wrapT:t.ClampToEdgeWrapping,minFilter:t.NearestFilter,magFilter:t.NearestFilter,stencilBuffer:!1,depthBuffer:!1,format:t.RGBAFormat,type:t.UnsignedByteType})},h.render=function(t,e){h.mesh.material=t,h.renderer.setRenderTarget(e),h.renderer.render(h.scene,h.camera),h.renderer.setRenderTarget(null)},h.FloatPack=o;var m=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;d(this,t),this.callbacks="function"==typeof e?[e]:e,this.fps=n,this.elapsed=0,this._last=0,this._deltaOffset=0,this._isPlaying=!1,this._update=this.update.bind(this)}var e,n,r;return e=t,(n=[{key:"add",value:function(t){this.has(t)||this.callbacks.push(t)}},{key:"remove",value:function(t){this.has(t)&&this.callbacks.splice(this.callbacks.indexOf(t),1)}},{key:"has",value:function(t){return this.callbacks.includes(t)}},{key:"reset",value:function(){this.elapsed=0}},{key:"start",value:function(){this._last=this.now,this._deltaOffset=0,this._isPlaying=!0,this.requestFrame()}},{key:"pause",value:function(){this._isPlaying=!1}},{key:"stop",value:function(){this.pause(),this.reset()}},{key:"update",value:function(){if(this.isPlaying){this.requestFrame();var e=Math.min(this.now-this._last,t.maxDelta);if(this._last=this.now,this.elapsed+=e,e>=this._frameDuration)return this.tick(e);this._deltaOffset+=e;var n=this._frameDuration-this._deltaOffset;n<=0&&(this.tick(this._frameDuration),this._deltaOffset=Math.abs(n)%this._frameDuration)}}},{key:"tick",value:function(t){var e=this;this.callbacks.forEach((function(n){return n(t,e.elapsed)}))}},{key:"requestFrame",value:function(){requestAnimationFrame(this._update)}},{key:"fps",get:function(){return this._fps},set:function(t){this._fps=t,this._frameDuration=t>0?Math.floor(1e3/t):0}},{key:"isPlaying",get:function(){return this._isPlaying}},{key:"now",get:function(){return t.time.now()}}])&&p(e.prototype,n),r&&p(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}m.maxDelta=100,m.time=Date||performance;var b=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.container,o=void 0===r?"sketch":r,i=n.width,a=n.height,s=n.fps,l=n.renderer,c=void 0===l?new t.WebGLRenderer({powerPreference:"high-performance",antialias:!1,stencil:!1,depth:!1}):l,u=n.debug,f=n.stats;if(v(this,e),this.renderer=c,this.canvas=c.domElement,this.pixelRatio=Math.min(window.devicePixelRatio,2),"string"==typeof o&&(o=document.getElementById(o)),o||(o=document.body),o.appendChild(this.canvas),o.style.touchAction="none",this.width=i>0?i:void 0,this.height=a>0?a:void 0,this.debug=u,this.fps=u?0:s,this.ticker=new m(this.tick.bind(this),s),f||u){this.stats=new e.Stats,o.appendChild(this.stats.domElement);var h=function(){this.stats.update()}.bind(this);this.ticker.add(h)}}var n,r,o;return n=e,r=[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sketch;this.sketch=t,this.resize(),this.sketch.init(),this.onResize=function(){this.needsResize=!0}.bind(this),window.addEventListener("resize",this.onResize),this.tick(0,0),this.ticker.start()}},{key:"dispose",value:function(){this.ticker.stop(),window.removeEventListener("resize",this.onResize),window.removeEventListener("touchstart",this.onTouchStart)}},{key:"resize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.width,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.height;t||(t=window.innerWidth),e||(e=window.innerHeight),this.renderer.setPixelRatio(this.pixelRatio),this.renderer.setSize(t,e),this.sketch.resize(t,e,this.pixelRatio),this.wide=t>1e3,this.needsResize=!1}},{key:"tick",value:function(t,e){this.needsResize&&this.resize(),this.renderer.clear(),this.sketch.tick(t,e)}}],r&&y(n.prototype,r),o&&y(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}b.Stats=window.Stats;var w=.5*(Math.sqrt(3)-1),x=(3-Math.sqrt(3))/6,P=1/6,O=(Math.sqrt(5)-1)/4,k=(5-Math.sqrt(5))/20,S=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),C=new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]);var T=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.p=function(t){for(var e=new Uint8Array(256),n=0;n<256;n++)e[n]=n;for(var r=0;r<255;r++){var o=r+~~(t.random()*(256-r)),i=e[r];e[r]=e[o],e[o]=i}return e}(e),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(var n=0;n<512;n++)this.perm[n]=this.p[255&n],this.permMod12[n]=this.perm[n]%12}var e,n,r;return e=t,(n=[{key:"noise2D",value:function(t,e){var n,r,o=this.permMod12,i=this.perm,a=0,s=0,l=0,c=(t+e)*w,u=Math.floor(t+c),f=Math.floor(e+c),h=(u+f)*x,d=t-(u-h),p=e-(f-h);d>p?(n=1,r=0):(n=0,r=1);var m=d-n+x,v=p-r+x,y=d-1+2*x,b=p-1+2*x,g=255&u,P=255&f,O=.5-d*d-p*p;if(O>=0){var k=3*o[g+i[P]];a=(O*=O)*O*(S[k]*d+S[k+1]*p)}var C=.5-m*m-v*v;if(C>=0){var T=3*o[g+n+i[P+r]];s=(C*=C)*C*(S[T]*m+S[T+1]*v)}var _=.5-y*y-b*b;if(_>=0){var j=3*o[g+1+i[P+1]];l=(_*=_)*_*(S[j]*y+S[j+1]*b)}return 70*(a+s+l)}},{key:"noise3D",value:function(t,e,n){var r,o,i,a,s,l,c,u,f,h,d=this.permMod12,p=this.perm,m=.3333333333333333*(t+e+n),v=Math.floor(t+m),y=Math.floor(e+m),b=Math.floor(n+m),g=(v+y+b)*P,w=t-(v-g),x=e-(y-g),O=n-(b-g);w>=x?x>=O?(s=1,l=0,c=0,u=1,f=1,h=0):w>=O?(s=1,l=0,c=0,u=1,f=0,h=1):(s=0,l=0,c=1,u=1,f=0,h=1):x<O?(s=0,l=0,c=1,u=0,f=1,h=1):w<O?(s=0,l=1,c=0,u=0,f=1,h=1):(s=0,l=1,c=0,u=1,f=1,h=0);var k=w-s+P,C=x-l+P,T=O-c+P,_=w-u+2*P,j=x-f+2*P,z=O-h+2*P,E=w-1+.5,R=x-1+.5,M=O-1+.5,U=255&v,D=255&y,A=255&b,G=.6-w*w-x*x-O*O;if(G<0)r=0;else{var F=3*d[U+p[D+p[A]]];r=(G*=G)*G*(S[F]*w+S[F+1]*x+S[F+2]*O)}var B=.6-k*k-C*C-T*T;if(B<0)o=0;else{var I=3*d[U+s+p[D+l+p[A+c]]];o=(B*=B)*B*(S[I]*k+S[I+1]*C+S[I+2]*T)}var L=.6-_*_-j*j-z*z;if(L<0)i=0;else{var Y=3*d[U+u+p[D+f+p[A+h]]];i=(L*=L)*L*(S[Y]*_+S[Y+1]*j+S[Y+2]*z)}var X=.6-E*E-R*R-M*M;if(X<0)a=0;else{var V=3*d[U+1+p[D+1+p[A+1]]];a=(X*=X)*X*(S[V]*E+S[V+1]*R+S[V+2]*M)}return 32*(r+o+i+a)}},{key:"noise4D",value:function(t,e,n,r){var o,i,a,s,l,c=this.perm,u=(t+e+n+r)*O,f=Math.floor(t+u),h=Math.floor(e+u),d=Math.floor(n+u),p=Math.floor(r+u),m=(f+h+d+p)*k,v=t-(f-m),y=e-(h-m),b=n-(d-m),g=r-(p-m),w=0,x=0,P=0,S=0;v>y?w++:x++,v>b?w++:P++,v>g?w++:S++,y>b?x++:P++,y>g?x++:S++,b>g?P++:S++;var T=w>=3?1:0,_=x>=3?1:0,j=P>=3?1:0,z=S>=3?1:0,E=w>=2?1:0,R=x>=2?1:0,M=P>=2?1:0,U=S>=2?1:0,D=w>=1?1:0,A=x>=1?1:0,G=P>=1?1:0,F=S>=1?1:0,B=v-T+k,I=y-_+k,L=b-j+k,Y=g-z+k,X=v-E+2*k,V=y-R+2*k,N=b-M+2*k,H=g-U+2*k,Z=v-D+3*k,W=y-A+3*k,Q=b-G+3*k,q=g-F+3*k,K=v-1+4*k,J=y-1+4*k,$=b-1+4*k,tt=g-1+4*k,et=255&f,nt=255&h,rt=255&d,ot=255&p,it=.6-v*v-y*y-b*b-g*g;if(it<0)o=0;else{var at=c[et+c[nt+c[rt+c[ot]]]]%32*4;o=(it*=it)*it*(C[at]*v+C[at+1]*y+C[at+2]*b+C[at+3]*g)}var st=.6-B*B-I*I-L*L-Y*Y;if(st<0)i=0;else{var lt=c[et+T+c[nt+_+c[rt+j+c[ot+z]]]]%32*4;i=(st*=st)*st*(C[lt]*B+C[lt+1]*I+C[lt+2]*L+C[lt+3]*Y)}var ct=.6-X*X-V*V-N*N-H*H;if(ct<0)a=0;else{var ut=c[et+E+c[nt+R+c[rt+M+c[ot+U]]]]%32*4;a=(ct*=ct)*ct*(C[ut]*X+C[ut+1]*V+C[ut+2]*N+C[ut+3]*H)}var ft=.6-Z*Z-W*W-Q*Q-q*q;if(ft<0)s=0;else{var ht=c[et+D+c[nt+A+c[rt+G+c[ot+F]]]]%32*4;s=(ft*=ft)*ft*(C[ht]*Z+C[ht+1]*W+C[ht+2]*Q+C[ht+3]*q)}var dt=.6-K*K-J*J-$*$-tt*tt;if(dt<0)l=0;else{var pt=c[et+1+c[nt+1+c[rt+1+c[ot+1]]]]%32*4;l=(dt*=dt)*dt*(C[pt]*K+C[pt+1]*J+C[pt+2]*$+C[pt+3]*tt)}return 27*(o+i+a+s+l)}}])&&g(e.prototype,n),r&&g(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var j=function(){function e(n,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o||(o=r),this.camera=n,this.near=r,this.far=o,this.depth=Math.abs(o-r),this.x=new t.Vector3,this.y=new t.Vector3,this.z=new t.Vector3}var n,r,o;return n=e,(r=[{key:"update",value:function(){var t=this.getVisibleHeight(this.far),e=t*this.camera.aspect;this.height=t,this.width=e,this.left=.5*-e,this.right=.5*e,this.top=.5*t,this.bottom=.5*-t,this.x.set(this.left,this.right,this.width),this.y.set(this.bottom,this.top,this.height),this.z.set(this.far,this.near,this.depth),this.needsUpdate=!1}},{key:"getVisibleHeight",value:function(t){return e.getVisibleHeight(this.camera,t)}},{key:"getVisibleWidth",value:function(t){return e.getVisibleWidth(this.camera,t)}}])&&_(n.prototype,r),o&&_(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();j.getVisibleHeight=function(t,e){var n=t.position.z;void 0===e&&(e=n),e+=e<n?-n:n;var r=t.fov*Math.PI/180;return 2*Math.tan(r/2)*Math.abs(e)},j.getVisibleWidth=function(t,e){return j.getVisibleHeight(t,e)*t.aspect};class z{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const E=new t.OrthographicCamera(-1,1,1,-1,0,1),R=new t.BufferGeometry;R.setAttribute("position",new t.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),R.setAttribute("uv",new t.Float32BufferAttribute([0,2,0,0,2,0],2));class M{constructor(e){this._mesh=new t.Mesh(R,e)}dispose(){this._mesh.geometry.dispose()}render(t){t.render(this._mesh,E)}get material(){return this._mesh.material}set material(t){this._mesh.material=t}}var U={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\t\t}"};const D={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new t.Color(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};class A extends z{constructor(e,n,r,o){super(),this.strength=void 0!==n?n:1,this.radius=r,this.threshold=o,this.resolution=void 0!==e?new t.Vector2(e.x,e.y):new t.Vector2(256,256),this.clearColor=new t.Color(0,0,0);const i={minFilter:t.LinearFilter,magFilter:t.LinearFilter,format:t.RGBAFormat};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let a=Math.round(this.resolution.x/2),s=Math.round(this.resolution.y/2);this.renderTargetBright=new t.WebGLRenderTarget(a,s,i),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let e=0;e<this.nMips;e++){const n=new t.WebGLRenderTarget(a,s,i);n.texture.name="UnrealBloomPass.h"+e,n.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(n);const r=new t.WebGLRenderTarget(a,s,i);r.texture.name="UnrealBloomPass.v"+e,r.texture.generateMipmaps=!1,this.renderTargetsVertical.push(r),a=Math.round(a/2),s=Math.round(s/2)}void 0===D&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const l=D;this.highPassUniforms=t.UniformsUtils.clone(l.uniforms),this.highPassUniforms.luminosityThreshold.value=o,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new t.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const c=[3,5,7,9,11];a=Math.round(this.resolution.x/2),s=Math.round(this.resolution.y/2);for(let e=0;e<this.nMips;e++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(c[e])),this.separableBlurMaterials[e].uniforms.texSize.value=new t.Vector2(a,s),a=Math.round(a/2),s=Math.round(s/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=n,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new t.Vector3(1,1,1),new t.Vector3(1,1,1),new t.Vector3(1,1,1),new t.Vector3(1,1,1),new t.Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===U&&console.error("THREE.UnrealBloomPass relies on CopyShader");const u=U;this.copyUniforms=t.UniformsUtils.clone(u.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new t.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,blending:t.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new t.Color,this.oldClearAlpha=1,this.basic=new t.MeshBasicMaterial,this.fsQuad=new M(null)}dispose(){for(let t=0;t<this.renderTargetsHorizontal.length;t++)this.renderTargetsHorizontal[t].dispose();for(let t=0;t<this.renderTargetsVertical.length;t++)this.renderTargetsVertical[t].dispose();this.renderTargetBright.dispose()}setSize(e,n){let r=Math.round(e/2),o=Math.round(n/2);this.renderTargetBright.setSize(r,o);for(let e=0;e<this.nMips;e++)this.renderTargetsHorizontal[e].setSize(r,o),this.renderTargetsVertical[e].setSize(r,o),this.separableBlurMaterials[e].uniforms.texSize.value=new t.Vector2(r,o),r=Math.round(r/2),o=Math.round(o/2)}render(t,e,n,r,o){t.getClearColor(this._oldClearColor),this.oldClearAlpha=t.getClearAlpha();const i=t.autoClear;t.autoClear=!1,t.setClearColor(this.clearColor,0),o&&t.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=n.texture,t.setRenderTarget(null),t.clear(),this.fsQuad.render(t)),this.highPassUniforms.tDiffuse.value=n.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,t.setRenderTarget(this.renderTargetBright),t.clear(),this.fsQuad.render(t);let a=this.renderTargetBright;for(let e=0;e<this.nMips;e++)this.fsQuad.material=this.separableBlurMaterials[e],this.separableBlurMaterials[e].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[e].uniforms.direction.value=A.BlurDirectionX,t.setRenderTarget(this.renderTargetsHorizontal[e]),t.clear(),this.fsQuad.render(t),this.separableBlurMaterials[e].uniforms.colorTexture.value=this.renderTargetsHorizontal[e].texture,this.separableBlurMaterials[e].uniforms.direction.value=A.BlurDirectionY,t.setRenderTarget(this.renderTargetsVertical[e]),t.clear(),this.fsQuad.render(t),a=this.renderTargetsVertical[e];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,t.setRenderTarget(this.renderTargetsHorizontal[0]),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,o&&t.state.buffers.stencil.setTest(!0),this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(n),this.fsQuad.render(t)),t.setClearColor(this._oldClearColor,this.oldClearAlpha),t.autoClear=i}getSeperableBlurMaterial(e){return new t.ShaderMaterial({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new t.Vector2(.5,.5)},direction:{value:new t.Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat fSigma = float(SIGMA);\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}getCompositeMaterial(e){return new t.ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform sampler2D dirtTexture;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}A.BlurDirectionX=new t.Vector2(1,0),A.BlurDirectionY=new t.Vector2(0,1);const G="vec3 bayerMatrixDither( vec3 color ) {\r\n\r\n\t// Silly code because old devices ( OpenGL ES < 3 ) don't support arrays\r\n\r\n\tint index = int( mod( gl_FragCoord.x - 0.5, 8.0 ) ) + \r\n\t\tint( mod( gl_FragCoord.y - 0.5, 8.0 ) * 8.0 );\r\n\r\n\tfloat dither = 0.0078;\r\n\r\n\tdither = ( index == 1 ) ? 0.0039 : dither;\r\n\tdither = ( index == 2 ) ? 0.0068 : dither;\r\n\tdither = ( index == 3 ) ? 0.0029 : dither;\r\n\tdither = ( index == 4 ) ? 0.0076 : dither;\r\n\tdither = ( index == 5 ) ? 0.0036 : dither;\r\n\tdither = ( index == 6 ) ? 0.0066 : dither;\r\n\tdither = ( index == 7 ) ? 0.0027 : dither;\r\n\r\n\tdither = ( index == 8 )  ? 0.0019 : dither;\r\n\tdither = ( index == 9 )  ? 0.0059 : dither;\r\n\tdither = ( index == 10 ) ? 0.0009 : dither;\r\n\tdither = ( index == 11 ) ? 0.0049 : dither;\r\n\tdither = ( index == 12 ) ? 0.0017 : dither;\r\n\tdither = ( index == 13 ) ? 0.0056 : dither;\r\n\tdither = ( index == 14 ) ? 0.0007 : dither;\r\n\tdither = ( index == 15 ) ? 0.0046 : dither;\r\n\r\n\tdither = ( index == 16 ) ? 0.0063 : dither;\r\n\tdither = ( index == 17 ) ? 0.0024 : dither;\r\n\tdither = ( index == 18 ) ? 0.0073 : dither;\r\n\tdither = ( index == 19 ) ? 0.0034 : dither;\r\n\tdither = ( index == 20 ) ? 0.0061 : dither;\r\n\tdither = ( index == 21 ) ? 0.0022 : dither;\r\n\tdither = ( index == 22 ) ? 0.0071 : dither;\r\n\tdither = ( index == 23 ) ? 0.0032 : dither;\r\n\r\n\tdither = ( index == 24 ) ? 0.0005 : dither;\r\n\tdither = ( index == 25 ) ? 0.0044 : dither;\r\n\tdither = ( index == 26 ) ? 0.0014 : dither;\r\n\tdither = ( index == 27 ) ? 0.0054 : dither;\r\n\tdither = ( index == 28 ) ? 0.0002 : dither;\r\n\tdither = ( index == 29 ) ? 0.0041 : dither;\r\n\tdither = ( index == 30 ) ? 0.0012 : dither;\r\n\tdither = ( index == 31 ) ? 0.0051 : dither;\r\n\r\n\tdither = ( index == 32 ) ? 0.0074 : dither;\r\n\tdither = ( index == 33 ) ? 0.0035 : dither;\r\n\tdither = ( index == 34 ) ? 0.0065 : dither;\r\n\tdither = ( index == 35 ) ? 0.0025 : dither;\r\n\tdither = ( index == 36 ) ? 0.0077 : dither;\r\n\tdither = ( index == 37 ) ? 0.0038 : dither;\r\n\tdither = ( index == 38 ) ? 0.0067 : dither;\r\n\tdither = ( index == 39 ) ? 0.0028 : dither;\r\n\r\n\tdither = ( index == 40 ) ? 0.0016 : dither;\r\n\tdither = ( index == 41 ) ? 0.0055 : dither;\r\n\tdither = ( index == 42 ) ? 0.0006 : dither;\r\n\tdither = ( index == 43 ) ? 0.0045 : dither;\r\n\tdither = ( index == 44 ) ? 0.0018 : dither;\r\n\tdither = ( index == 45 ) ? 0.0057 : dither;\r\n\tdither = ( index == 46 ) ? 0.0008 : dither;\r\n\tdither = ( index == 47 ) ? 0.0047 : dither;\r\n\r\n\tdither = ( index == 48 ) ? 0.006  : dither;\r\n\tdither = ( index == 49 ) ? 0.0021 : dither;\r\n\tdither = ( index == 50 ) ? 0.007  : dither;\r\n\tdither = ( index == 51 ) ? 0.003  : dither;\r\n\tdither = ( index == 52 ) ? 0.0062 : dither;\r\n\tdither = ( index == 53 ) ? 0.0023 : dither;\r\n\tdither = ( index == 54 ) ? 0.0072 : dither;\r\n\tdither = ( index == 55 ) ? 0.0033 : dither;\r\n\r\n\tdither = ( index == 56 ) ? 0.0001 : dither;\r\n\tdither = ( index == 57 ) ? 0.004  : dither;\r\n\tdither = ( index == 58 ) ? 0.0011 : dither;\r\n\tdither = ( index == 59 ) ? 0.005  : dither;\r\n\tdither = ( index == 60 ) ? 0.0003 : dither;\r\n\tdither = ( index == 61 ) ? 0.0043 : dither;\r\n\tdither = ( index == 62 ) ? 0.0013 : dither;\r\n\tdither = ( index == 63 ) ? 0.0052 : dither;\r\n\r\n\treturn color - dither;\r\n\t\r\n}";function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function B(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function L(t,e){return L=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},L(t,e)}function Y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=V(t);if(e){var o=V(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return X(this,n)}}function X(t,e){if(e&&("object"===F(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function V(t){return V=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},V(t)}var N=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&L(t,e)}(a,e);var n,r,o,i=Y(a);function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.strength,r=void 0===n?.6:n,o=e.radius,s=void 0===o?1:o,l=e.threshold,c=void 0===l?.3:l;return B(this,a),i.call(this,new t.Vector2,r,s,c)}return n=a,(r=[{key:"getCompositeMaterial",value:function(e){return new t.ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform sampler2D dirtTexture;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\t".concat(G,"\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 color = bloomStrength * ( \n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv)\n\t\t\t\t\t);\n\n\t\t\t\t\tcolor.rgb = bayerMatrixDither( color.rgb );\n\n\t\t\t\t\tgl_FragColor = color;\n\t\t\t\t}\n\t\t\t")})}}])&&I(n.prototype,r),o&&I(n,o),Object.defineProperty(n,"prototype",{writable:!1}),a}(A);function H(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var W=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math;H(this,t),this.prng=e}var e,n,r;return e=t,n=[{key:"random",value:function(){return this.prng.random()}},{key:"amount",value:function(){return this.random()}},{key:"number",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.random();return isNaN(t)||isNaN(e)?r:n?Math.floor(r*(e-t+1)+t):r*(e-t)+t}},{key:"noise",value:function(){return this.number(-1,1)}},{key:"int",value:function(t,e){return this.number(t,e,!0)}},{key:"uint",value:function(t){return this.int(0,t)}},{key:"boolean",value:function(){return this.random()<.5}},{key:"chance",value:function(t){return this.random()<t}},{key:"item",value:function(t){return t[this.uint(t.length-1)]}},{key:"char",value:function(t){return t.charAt(this.uint(t.length-1))}}],n&&Z(e.prototype,n),r&&Z(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();const Q="vec3 linearGradient( \r\n\tvec2 origin,\r\n\tvec2 target,\r\n\tvec3 color1,\r\n\tvec3 color2,\r\n\tfloat angle\r\n) {\r\n\r\n\tfloat toTarget = length( target );\r\n\tangle = radians( angle ) + atan( target.y, target.x );\r\n\r\n\tfloat progressX = cos( angle ) * toTarget;\r\n\tfloat progressY = sin( angle ) * toTarget;\r\n\tvec2 progress = vec2( progressX, progressY ) + origin;\r\n\r\n\treturn mix( color1, color2, smoothstep( 0.0, 1.0, progress.x ) );\r\n\t\r\n}";function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function K(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function J(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?K(Object(n),!0).forEach((function(e){$(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function $(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nt(t,e){return nt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},nt(t,e)}function rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=it(t);if(e){var o=it(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ot(this,n)}}function ot(t,e){if(e&&("object"===q(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function it(t){return it=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},it(t)}var at=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nt(t,e)}(a,e);var n,r,o,i=rt(a);function a(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.color1,o=void 0===r?16777215:r,s=n.color2,l=void 0===s?0:s,c=n.angle,u=void 0===c?90:c;tt(this,a);var f=new t.PlaneGeometry(2,2),h=new t.ShaderMaterial(J(J({},a.shader),{},{uniforms:{uAngle:{value:u},uColor1:{value:new t.Color(o)},uColor2:{value:new t.Color(l)}}}));return(e=i.call(this,f,h)).frustumCulled=!1,e}return n=a,(r=[{key:"angle",get:function(){return this.material.uniforms.uAngle.value},set:function(t){this.material.uniforms.uAngle.value=t}},{key:"color1",get:function(){return this.material.uniforms.uColor1.value},set:function(t){this.material.uniforms.uColor1.value=t}},{key:"color2",get:function(){return this.material.uniforms.uColor2.value},set:function(t){this.material.uniforms.uColor2.value=t}}])&&et(n.prototype,r),o&&et(n,o),Object.defineProperty(n,"prototype",{writable:!1}),a}(t.Mesh);at.shader={depthWrite:!1,depthTest:!1,vertexShader:"varying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\r\n\tgl_Position = vec4( position, 1.0 );\r\n\r\n}",fragmentShader:"\n\t\tuniform float uAngle;\n\t\tuniform vec3 uColor1;\n\t\tuniform vec3 uColor2;\n\t\tvarying vec2 vUv;\n\t\t\n\t\t".concat(Q,"\n\t\t").concat(G,"\n\n\t\tvoid main() {\n\n\t\t\tvec2 origin = vec2( 0.5, 0.5 );\n\t\t\tvec2 target = vUv - origin;\n\t\t\tvec3 color = linearGradient( origin, target, uColor1, uColor2, uAngle );\n\t\t\t\n\t\t\tcolor = bayerMatrixDither( color );\n\n\t\t\tgl_FragColor = vec4( color, 1.0 );\n\t\t\t\n\t\t}")};class st extends z{constructor(e,n){super(),this.textureID=void 0!==n?n:"tDiffuse",e instanceof t.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=t.UniformsUtils.clone(e.uniforms),this.material=new t.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new M(this.material)}render(t,e,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(e),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),this.fsQuad.render(t))}}class lt extends z{constructor(t,e){super(),this.scene=t,this.camera=e,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(t,e,n){const r=t.getContext(),o=t.state;let i,a;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0),this.inverse?(i=0,a=1):(i=1,a=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),o.buffers.stencil.setFunc(r.ALWAYS,i,4294967295),o.buffers.stencil.setClear(a),o.buffers.stencil.setLocked(!0),t.setRenderTarget(n),this.clear&&t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(e),this.clear&&t.clear(),t.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(r.EQUAL,1,4294967295),o.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),o.buffers.stencil.setLocked(!0)}}class ct extends z{constructor(){super(),this.needsSwap=!1}render(t){t.state.buffers.stencil.setLocked(!1),t.state.buffers.stencil.setTest(!1)}}class ut{constructor(e,n){if(this.renderer=e,void 0===n){const r={minFilter:t.LinearFilter,magFilter:t.LinearFilter,format:t.RGBAFormat},o=e.getSize(new t.Vector2);this._pixelRatio=e.getPixelRatio(),this._width=o.width,this._height=o.height,(n=new t.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,r)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=n.width,this._height=n.height;this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===U&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===st&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new st(U),this.clock=new t.Clock}swapBuffers(){const t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t}addPass(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(t,e){this.passes.splice(e,0,t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(t){const e=this.passes.indexOf(t);-1!==e&&this.passes.splice(e,1)}isLastEnabledPass(t){for(let e=t+1;e<this.passes.length;e++)if(this.passes[e].enabled)return!1;return!0}render(t){void 0===t&&(t=this.clock.getDelta());const e=this.renderer.getRenderTarget();let n=!1;for(let e=0,r=this.passes.length;e<r;e++){const r=this.passes[e];if(!1!==r.enabled){if(r.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(e),r.render(this.renderer,this.writeBuffer,this.readBuffer,t,n),r.needsSwap){if(n){const e=this.renderer.getContext(),n=this.renderer.state.buffers.stencil;n.setFunc(e.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),n.setFunc(e.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==lt&&(r instanceof lt?n=!0:r instanceof ct&&(n=!1))}}this.renderer.setRenderTarget(e)}reset(e){if(void 0===e){const n=this.renderer.getSize(new t.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=n.width,this._height=n.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(t,e){this._width=t,this._height=e;const n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(let t=0;t<this.passes.length;t++)this.passes[t].setSize(n,r)}setPixelRatio(t){this._pixelRatio=t,this.setSize(this._width,this._height)}}new t.OrthographicCamera(-1,1,1,-1,0,1);const ft=new t.BufferGeometry;ft.setAttribute("position",new t.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),ft.setAttribute("uv",new t.Float32BufferAttribute([0,2,0,0,2,0],2));class ht extends z{constructor(e,n,r,o,i){super(),this.scene=e,this.camera=n,this.overrideMaterial=r,this.clearColor=o,this.clearAlpha=void 0!==i?i:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new t.Color}render(t,e,n){const r=t.autoClear;let o,i;t.autoClear=!1,void 0!==this.overrideMaterial&&(i=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(t.getClearColor(this._oldClearColor),o=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:n),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor&&t.setClearColor(this._oldClearColor,o),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=i),t.autoClear=r}}function dt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var mt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.renderer,r=e.stage,o=e.renderToScreen,i=void 0===o||o;dt(this,t),this.composer=new ut(n),this.composer.renderToScreen=i,this.passes={},this.add("render",new ht(r.scene,r.camera))}var e,n,r;return e=t,(n=[{key:"add",value:function(t,e){this.passes[t]=e,this.composer.addPass(e)}},{key:"remove",value:function(t){var e,n=this.passes[t];n&&(this.composer.removePass(n),null==n||null===(e=n.dispose)||void 0===e||e.call(n),delete this.passes[t])}},{key:"resize",value:function(t,e,n){this.composer.setSize(t,e),Object.values(this.passes).forEach((function(r){return null==r?void 0:r.setSize(t,e,n)}))}},{key:"tick",value:function(){this.composer.render()}},{key:"dispose",value:function(){Object.values(this.passes).forEach((function(t){var e;return null==t||null===(e=t.dispose)||void 0===e?void 0:e.call(t)})),Object.values(this).forEach((function(t){var e;return null==t||null===(e=t.dispose)||void 0===e?void 0:e.call(t)}))}}])&&pt(e.prototype,n),r&&pt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function vt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var bt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.target,r=void 0===n?window:n,o=e.width,i=void 0===o?window.innerWidth:o,a=e.height,s=void 0===a?window.innerHeight:a,l=e.margin,c=void 0===l?0:l,u=e.marginTop,f=e.marginRight,h=e.marginBottom,d=e.marginLeft,p=e.enabled,m=void 0===p||p,v=e.debug,y=void 0!==v&&v,b=e.preventDefault,g=void 0!==b&&b,w=e.onChange;vt(this,t);var x=function(t){return"number"==typeof t&&t>=0?t:c};this.margin={top:x(u),right:x(f),bottom:x(h),left:x(d)},this.hitbox={top:this.margin.top,left:this.margin.left,width:i,height:s},this.resize(i,s),this.x=this.y=.5,this.target=r,this.onMouseMove=function(t){g&&t.preventDefault&&t.preventDefault(),this.track(t.clientX,t.clientY)}.bind(this),this.onTouchMove=function(t){g&&t.preventDefault(),this.onMouseMove(t.targetTouches[0])}.bind(this),this.onChange=w,y&&(this.onDebug=this.log),m&&this.enable()}var e,n,r;return e=t,(n=[{key:"enable",value:function(){this._enabled||(this.target.addEventListener("touchmove",this.onTouchMove),this.target.addEventListener("mousemove",this.onMouseMove),this._enabled=!0)}},{key:"disable",value:function(){this._enabled&&(this.target.removeEventListener("touchmove",this.onTouchMove),this.target.removeEventListener("mousemove",this.onMouseMove),this._enabled=!1)}},{key:"dispose",value:function(){this.disable()}},{key:"track",value:function(t,e){var n,r,o;if(this.clientX!==t){this.clientX=t;var i=this.normalizeX;this.x!==i&&(this.x=i,o=!0)}if(this.clientY!==e){this.clientY=e;var a=this.normalizeY;this.y!==a&&(this.y=a,o=!0)}o&&(null===(n=this.onChange)||void 0===n||n.call(this),null===(r=this.onDebug)||void 0===r||r.call(this))}},{key:"resize",value:function(t,e){var n=this.margin.left*t,r=this.margin.right*t;this.hitbox.width=t-n-r,this.offsetX=n;var o=this.margin.top*e,i=this.margin.bottom*e;this.hitbox.height=e-o-i,this.offsetY=o}},{key:"log",value:function(){var t=this.x,e=this.y,n=this.reverseX,r=this.reverseY,o=this.polarizeX,i=this.polarizeY,a=this.reversePolarizeX,s=this.reversePolarizeY,l=this.centerX,c=this.centerY,u=this.reverseCenterX,f=this.reverseCenterY;console.log({x:t,y:e,reverseX:n,reverseY:r,polarizeX:o,polarizeY:i,reversePolarizeX:a,reversePolarizeY:s,centerX:l,centerY:c,reverseCenterX:u,reverseCenterY:f})}},{key:"normalizeX",get:function(){return t.normalize(this.clientX-this.offsetX,this.hitbox.width)}},{key:"normalizeY",get:function(){return t.normalize(this.clientY-this.offsetY,this.hitbox.height)}},{key:"reverseX",get:function(){return t.reverse(this.x)}},{key:"reverseY",get:function(){return t.reverse(this.y)}},{key:"polarizeX",get:function(){return t.polarize(this.x)}},{key:"polarizeY",get:function(){return t.polarize(this.y)}},{key:"reversePolarizeX",get:function(){return t.reversePolarize(this.x)}},{key:"reversePolarizeY",get:function(){return t.reversePolarize(this.y)}},{key:"centerX",get:function(){return t.center(this.x)}},{key:"centerY",get:function(){return t.center(this.y)}},{key:"reverseCenterX",get:function(){return t.reverseCenter(this.x)}},{key:"reverseCenterY",get:function(){return t.reverseCenter(this.y)}}])&&yt(e.prototype,n),r&&yt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function gt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}bt.clamp=function(t){return t>1?1:t<0?0:t},bt.normalize=function(t,e){return bt.clamp(t/e)},bt.reverse=function(t){return 1-t},bt.polarize=function(t){return 2*t-1},bt.reversePolarize=function(t){return 1-2*t},bt.center=function(t){return 1-2*Math.abs(t-.5)},bt.reverseCenter=function(t){return 2*Math.abs(t-.5)};var xt=function(){function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.lookAt,i=void 0===o?{x:0,y:0,z:0}:o,a=r.bounds,s=void 0===a?{x:5,y:5,z:0}:a,l=r.speed,c=void 0===l?.002:l,u=r.intro;gt(this,e),this.camera=n,this.lookAt=new t.Vector3(i.x,i.y,i.z),this.bounds=new t.Vector3(s.x,s.y,s.z),this.speed=c,this.origin=(new t.Vector3).copy(n.position),this.target=new t.Vector3,u&&this.set(u.x,u.y,u.z)}var n,r,o;return n=e,r=[{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.camera.position.set(t,e,n),this}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.target.x=this.origin.x+this.bounds.x*t,this.target.y=this.origin.y+this.bounds.y*e,this.target.z=this.origin.z+this.bounds.z*n,this}},{key:"tick",value:function(e){var n=t.MathUtils.clamp(this.speed*e,0,1);return this.camera.position.lerp(this.target,n),this.camera.lookAt(this.lookAt),this}}],r&&wt(n.prototype,r),o&&wt(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();function Pt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var kt=function(){function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.plane,i=r.width,a=void 0===i?1e3:i,s=r.height,l=void 0===s?1e3:s,c=r.horizontal,u=void 0!==c&&c,f=r.cursor,h=r.cursorSize,d=void 0===h?.1:h,p=r.color,m=void 0===p?16711680:p,v=r.opacity,y=void 0===v?.15:v,b=r.lerp,g=r.autoRotate;Pt(this,e),o||(o=new t.Mesh(new t.PlaneGeometry(a,l),new t.MeshBasicMaterial({color:m,opacity:y,transparent:y<1})),u&&o.rotateX(-Math.PI/2)),f||(f=new t.Mesh(new t.BoxGeometry(d,d,d),new t.MeshBasicMaterial({color:m}))),n.add(o),n.add(f),this.plane=o,this.cursor=f,this.lerp=b,this.autoRotate=g,this.camera=n.camera,this.tracker=new t.Vector2,this.raycaster=new t.Raycaster,n.debug||(this.plane.visible=!1,this.cursor.visible=!1)}var n,r,o;return n=e,(r=[{key:"set",value:function(t,e){this.tracker.set(t,e)}},{key:"tick",value:function(e){this.autoRotate&&this.plane.quaternion.copy(this.camera.quaternion),this.raycaster.setFromCamera(this.tracker,this.camera);var n=this.raycaster.intersectObject(this.plane)[0];if(null!=n&&n.point){if(!this.lerp)return this.cursor.position.copy(n.point);var r=t.MathUtils.clamp(this.lerp*e,0,1);this.cursor.position.lerp(n.point,r)}}}])&&Ot(n.prototype,r),o&&Ot(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();function St(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ct=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sketch=e,!1!==e.settings.cursorTracker&&this.initTracker(),e.settings.cursorProjector&&this.initProjector(),e.settings.cameraRig&&this.initCameraRig(),e.settings.gui&&this.initGUI()}var e,n,r;return e=t,(n=[{key:"initTracker",value:function(){this.tracker=new bt,this.trackerEnabled=!0}},{key:"initProjector",value:function(){this.projector=new kt(this.sketch,this.sketch.settings.cursorProjector),this.cursor=this.projector.cursor}},{key:"initCameraRig",value:function(){var t=this.sketch.settings,e=t.camera.lookAt,n=t.cameraRig.bounds,r=t.cameraRig.speed,o=t.cameraRig.intro;this.cameraRig=new xt(this.sketch.camera,{lookAt:e,bounds:n,speed:r,intro:o}),this.cameraRigEnabled=!0}},{key:"initGUI",value:function(){this.gui=new t.GUI,this.gui.title(this.sketch.name.toUpperCase()),this.autoCloseGUI()}},{key:"autoCloseGUI",value:function(){this.gui&&(this.sketch.sketchpad.wide||this.gui.close())}},{key:"refreshGUI",value:function(){this.gui&&!this.gui._closed&&this.gui.controllersRecursive().forEach((function(t){return t.updateDisplay()}))}},{key:"resize",value:function(t,e){var n;null===(n=this.tracker)||void 0===n||n.resize(t,e),this.autoCloseGUI()}},{key:"tick",value:function(t){this.cameraRigEnabled&&this.cameraRig.update(this.tracker.reversePolarizeX,this.tracker.y).tick(t)}}])&&St(e.prototype,n),r&&St(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Tt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Ct.GUI=window.GUI,Ct.VALUE="value",Ct.clamp=t.MathUtils.clamp,Ct.lerp=t.MathUtils.lerp;var jt=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.background,o=n.camera;if(Tt(this,e),this.scene=new t.Scene,r&&(this.scene.background=r),o){if(o instanceof t.Camera==!1){var i=o.start,a=o.lookAt;o=new t.PerspectiveCamera(o.fov,o.aspect,o.near,o.far),i&&o.position.set(i.x,i.y,i.z),a&&o.lookAt(a.x,a.y,a.z)}}else o=new t.PerspectiveCamera;this.camera=o}var n,r,o;return n=e,(r=[{key:"add",value:function(t){this.scene.add(t)}},{key:"remove",value:function(t){this.scene.remove(t)}},{key:"resize",value:function(t,e){this.camera.aspect=t/e,this.camera.updateProjectionMatrix()}}])&&_t(n.prototype,r),o&&_t(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();function zt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Et(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?zt(Object(n),!0).forEach((function(e){Rt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Rt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Dt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.defaults,r=void 0===n?{}:n,o=t.settings,i=void 0===o?{}:o,a=t.stage,s=t.background,l=t.random;Mt(this,e),i=Et(Et({},r),i),this.settings=i,a||(a=new jt(i)),this.stage=a;var c=i.sketchpad||new b;this.sketchpad=c,this.effects=new mt({renderer:c.renderer,stage:a,renderToScreen:i.renderToScreen}),this.random=l||i.random?new W:null,!s&&i.background&&this.initBackground()}var n,r,o;return n=e,r=[{key:"initBackground",value:function(){var e=this.settings.background,n=e instanceof t.Color?e:("string"==typeof e||"number"==typeof e)&&new t.Color(e);if(n)return this.stage.scene.background=n;e.color1&&e.color2&&(this.background=new at(e),this.add(this.background))}},{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ct;this.initScene(),t&&(this.controls=new t(this))}},{key:"initScene",value:function(){}},{key:"dispose",value:function(){this.stage.dispose(),this.effects.dispose()}},{key:"resize",value:function(t,e,n){var r,o;this.stage.resize(t,e),null===(r=this.controls)||void 0===r||r.resize(t,e),null===(o=this.effects)||void 0===o||o.resize(t,e,n)}},{key:"tick",value:function(t,e){var n;null===(n=this.controls)||void 0===n||n.tick(t,e),this.effects.tick(t,e)}},{key:"add",value:function(t){this.stage.add(t)}},{key:"remove",value:function(t){this.stage.remove(t)}},{key:"camera",get:function(){return this.stage.camera}},{key:"debug",get:function(){return this.sketchpad.debug}},{key:"name",get:function(){return this.settings.name||"Sketch"}},{key:"output",get:function(){return this.effects.composer.readBuffer.texture}}],r&&Ut(n.prototype,r),o&&Ut(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();const At={type:"change"},Gt={type:"start"},Ft={type:"end"};class Bt extends t.EventDispatcher{constructor(e,n){super(),void 0===n&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),n===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=n,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new t.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:t.MOUSE.ROTATE,MIDDLE:t.MOUSE.DOLLY,RIGHT:t.MOUSE.PAN},this.touches={ONE:t.TOUCH.ROTATE,TWO:t.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return s.phi},this.getAzimuthalAngle=function(){return s.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",V),this._domElementKeyEvents=t},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(At),r.update(),i=o.NONE},this.update=function(){const n=new t.Vector3,h=(new t.Quaternion).setFromUnitVectors(e.up,new t.Vector3(0,1,0)),d=h.clone().invert(),p=new t.Vector3,m=new t.Quaternion,v=2*Math.PI;return function(){const t=r.object.position;n.copy(t).sub(r.target),n.applyQuaternion(h),s.setFromVector3(n),r.autoRotate&&i===o.NONE&&k(2*Math.PI/60/60*r.autoRotateSpeed),r.enableDamping?(s.theta+=l.theta*r.dampingFactor,s.phi+=l.phi*r.dampingFactor):(s.theta+=l.theta,s.phi+=l.phi);let e=r.minAzimuthAngle,y=r.maxAzimuthAngle;return isFinite(e)&&isFinite(y)&&(e<-Math.PI?e+=v:e>Math.PI&&(e-=v),y<-Math.PI?y+=v:y>Math.PI&&(y-=v),s.theta=e<=y?Math.max(e,Math.min(y,s.theta)):s.theta>(e+y)/2?Math.max(e,s.theta):Math.min(y,s.theta)),s.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,s.phi)),s.makeSafe(),s.radius*=c,s.radius=Math.max(r.minDistance,Math.min(r.maxDistance,s.radius)),!0===r.enableDamping?r.target.addScaledVector(u,r.dampingFactor):r.target.add(u),n.setFromSpherical(s),n.applyQuaternion(d),t.copy(r.target).add(n),r.object.lookAt(r.target),!0===r.enableDamping?(l.theta*=1-r.dampingFactor,l.phi*=1-r.dampingFactor,u.multiplyScalar(1-r.dampingFactor)):(l.set(0,0,0),u.set(0,0,0)),c=1,!!(f||p.distanceToSquared(r.object.position)>a||8*(1-m.dot(r.object.quaternion))>a)&&(r.dispatchEvent(At),p.copy(r.object.position),m.copy(r.object.quaternion),f=!1,!0)}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",N),r.domElement.removeEventListener("pointerdown",B),r.domElement.removeEventListener("pointercancel",Y),r.domElement.removeEventListener("wheel",X),r.domElement.removeEventListener("pointermove",I),r.domElement.removeEventListener("pointerup",L),null!==r._domElementKeyEvents&&r._domElementKeyEvents.removeEventListener("keydown",V)};const r=this,o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let i=o.NONE;const a=1e-6,s=new t.Spherical,l=new t.Spherical;let c=1;const u=new t.Vector3;let f=!1;const h=new t.Vector2,d=new t.Vector2,p=new t.Vector2,m=new t.Vector2,v=new t.Vector2,y=new t.Vector2,b=new t.Vector2,g=new t.Vector2,w=new t.Vector2,x=[],P={};function O(){return Math.pow(.95,r.zoomSpeed)}function k(t){l.theta-=t}function S(t){l.phi-=t}const C=function(){const e=new t.Vector3;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),u.add(e)}}(),T=function(){const e=new t.Vector3;return function(t,n){!0===r.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),u.add(e)}}(),_=function(){const e=new t.Vector3;return function(t,n){const o=r.domElement;if(r.object.isPerspectiveCamera){const i=r.object.position;e.copy(i).sub(r.target);let a=e.length();a*=Math.tan(r.object.fov/2*Math.PI/180),C(2*t*a/o.clientHeight,r.object.matrix),T(2*n*a/o.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(C(t*(r.object.right-r.object.left)/r.object.zoom/o.clientWidth,r.object.matrix),T(n*(r.object.top-r.object.bottom)/r.object.zoom/o.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function j(t){r.object.isPerspectiveCamera?c/=t:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*t)),r.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function z(t){r.object.isPerspectiveCamera?c*=t:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/t)),r.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function E(t){h.set(t.clientX,t.clientY)}function R(t){m.set(t.clientX,t.clientY)}function M(){if(1===x.length)h.set(x[0].pageX,x[0].pageY);else{const t=.5*(x[0].pageX+x[1].pageX),e=.5*(x[0].pageY+x[1].pageY);h.set(t,e)}}function U(){if(1===x.length)m.set(x[0].pageX,x[0].pageY);else{const t=.5*(x[0].pageX+x[1].pageX),e=.5*(x[0].pageY+x[1].pageY);m.set(t,e)}}function D(){const t=x[0].pageX-x[1].pageX,e=x[0].pageY-x[1].pageY,n=Math.sqrt(t*t+e*e);b.set(0,n)}function A(t){if(1==x.length)d.set(t.pageX,t.pageY);else{const e=W(t),n=.5*(t.pageX+e.x),r=.5*(t.pageY+e.y);d.set(n,r)}p.subVectors(d,h).multiplyScalar(r.rotateSpeed);const e=r.domElement;k(2*Math.PI*p.x/e.clientHeight),S(2*Math.PI*p.y/e.clientHeight),h.copy(d)}function G(t){if(1===x.length)v.set(t.pageX,t.pageY);else{const e=W(t),n=.5*(t.pageX+e.x),r=.5*(t.pageY+e.y);v.set(n,r)}y.subVectors(v,m).multiplyScalar(r.panSpeed),_(y.x,y.y),m.copy(v)}function F(t){const e=W(t),n=t.pageX-e.x,o=t.pageY-e.y,i=Math.sqrt(n*n+o*o);g.set(0,i),w.set(0,Math.pow(g.y/b.y,r.zoomSpeed)),j(w.y),b.copy(g)}function B(e){!1!==r.enabled&&(0===x.length&&(r.domElement.setPointerCapture(e.pointerId),r.domElement.addEventListener("pointermove",I),r.domElement.addEventListener("pointerup",L)),function(t){x.push(t)}(e),"touch"===e.pointerType?function(e){switch(Z(e),x.length){case 1:switch(r.touches.ONE){case t.TOUCH.ROTATE:if(!1===r.enableRotate)return;M(),i=o.TOUCH_ROTATE;break;case t.TOUCH.PAN:if(!1===r.enablePan)return;U(),i=o.TOUCH_PAN;break;default:i=o.NONE}break;case 2:switch(r.touches.TWO){case t.TOUCH.DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&D(),r.enablePan&&U(),i=o.TOUCH_DOLLY_PAN;break;case t.TOUCH.DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&D(),r.enableRotate&&M(),i=o.TOUCH_DOLLY_ROTATE;break;default:i=o.NONE}break;default:i=o.NONE}i!==o.NONE&&r.dispatchEvent(Gt)}(e):function(e){let n;switch(e.button){case 0:n=r.mouseButtons.LEFT;break;case 1:n=r.mouseButtons.MIDDLE;break;case 2:n=r.mouseButtons.RIGHT;break;default:n=-1}switch(n){case t.MOUSE.DOLLY:if(!1===r.enableZoom)return;!function(t){b.set(t.clientX,t.clientY)}(e),i=o.DOLLY;break;case t.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enablePan)return;R(e),i=o.PAN}else{if(!1===r.enableRotate)return;E(e),i=o.ROTATE}break;case t.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enableRotate)return;E(e),i=o.ROTATE}else{if(!1===r.enablePan)return;R(e),i=o.PAN}break;default:i=o.NONE}i!==o.NONE&&r.dispatchEvent(Gt)}(e))}function I(t){!1!==r.enabled&&("touch"===t.pointerType?function(t){switch(Z(t),i){case o.TOUCH_ROTATE:if(!1===r.enableRotate)return;A(t),r.update();break;case o.TOUCH_PAN:if(!1===r.enablePan)return;G(t),r.update();break;case o.TOUCH_DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;!function(t){r.enableZoom&&F(t),r.enablePan&&G(t)}(t),r.update();break;case o.TOUCH_DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;!function(t){r.enableZoom&&F(t),r.enableRotate&&A(t)}(t),r.update();break;default:i=o.NONE}}(t):function(t){if(!1===r.enabled)return;switch(i){case o.ROTATE:if(!1===r.enableRotate)return;!function(t){d.set(t.clientX,t.clientY),p.subVectors(d,h).multiplyScalar(r.rotateSpeed);const e=r.domElement;k(2*Math.PI*p.x/e.clientHeight),S(2*Math.PI*p.y/e.clientHeight),h.copy(d),r.update()}(t);break;case o.DOLLY:if(!1===r.enableZoom)return;!function(t){g.set(t.clientX,t.clientY),w.subVectors(g,b),w.y>0?j(O()):w.y<0&&z(O()),b.copy(g),r.update()}(t);break;case o.PAN:if(!1===r.enablePan)return;!function(t){v.set(t.clientX,t.clientY),y.subVectors(v,m).multiplyScalar(r.panSpeed),_(y.x,y.y),m.copy(v),r.update()}(t)}}(t))}function L(t){H(t),0===x.length&&(r.domElement.releasePointerCapture(t.pointerId),r.domElement.removeEventListener("pointermove",I),r.domElement.removeEventListener("pointerup",L)),r.dispatchEvent(Ft),i=o.NONE}function Y(t){H(t)}function X(t){!1!==r.enabled&&!1!==r.enableZoom&&i===o.NONE&&(t.preventDefault(),r.dispatchEvent(Gt),function(t){t.deltaY<0?z(O()):t.deltaY>0&&j(O()),r.update()}(t),r.dispatchEvent(Ft))}function V(t){!1!==r.enabled&&!1!==r.enablePan&&function(t){let e=!1;switch(t.code){case r.keys.UP:_(0,r.keyPanSpeed),e=!0;break;case r.keys.BOTTOM:_(0,-r.keyPanSpeed),e=!0;break;case r.keys.LEFT:_(r.keyPanSpeed,0),e=!0;break;case r.keys.RIGHT:_(-r.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),r.update())}(t)}function N(t){!1!==r.enabled&&t.preventDefault()}function H(t){delete P[t.pointerId];for(let e=0;e<x.length;e++)if(x[e].pointerId==t.pointerId)return void x.splice(e,1)}function Z(e){let n=P[e.pointerId];void 0===n&&(n=new t.Vector2,P[e.pointerId]=n),n.set(e.pageX,e.pageY)}function W(t){const e=t.pointerId===x[0].pointerId?x[1]:x[0];return P[e.pointerId]}r.domElement.addEventListener("contextmenu",N),r.domElement.addEventListener("pointerdown",B),r.domElement.addEventListener("pointercancel",Y),r.domElement.addEventListener("wheel",X,{passive:!1}),this.update()}}function It(t){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},It(t)}function Lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yt(){return Yt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Xt(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Yt.apply(this,arguments)}function Xt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Zt(t)););return t}function Vt(t,e){return Vt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Vt(t,e)}function Nt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Zt(t);if(e){var o=Zt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ht(this,n)}}function Ht(t,e){if(e&&("object"===It(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Zt(t){return Zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Zt(t)}var Wt=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vt(t,e)}(a,e);var n,r,o,i=Nt(a);function a(e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e)).intensity=1,n.cursorPrevious=new t.Vector2(.5,.5),n.cursorCurrent=new t.Vector2,n.orbit=new Bt(e.camera,e.sketchpad.canvas),n.trackerEnabled=!1,n}return n=a,r=[{key:"initGUI",value:function(){Yt(Zt(a.prototype),"initGUI",this).call(this);var t=this.gui,e=this.sketch,n=e.settings,r=n.targeted,o=function(){e.targeted.uniforms.color.value.copy(e.mesh.material.color),e.targeted.uniforms.opacity.value=e.mesh.material.opacity},i=t.addFolder("Animation");i.add(this,"trackerEnabled").name("cursorTracker").listen(),i.add(e.mesh,"count",0,n.instances).step(1).name("density"),i.add(e,"speed",1e-4,.002),i.add(n,"spread",.1,2).onFinishChange((function(){return e.updateAspect()}));var s=t.addFolder("Cursor Generation");s.add(r,"scatter",0,1),s.add(r,"spread",0,10),s.add(r.delay,"min",0,.02).name("spacing");var l=t.addFolder("Colors");l.addColor(e.background,"color1").name("background1"),l.addColor(e.background,"color2").name("background2"),l.addColor(e.mesh.material,"color").onChange(o),l.add(e.mesh.material,"opacity",0,1).onChange(o);var c=t.addFolder("Bloom").close();c.add(e.effects.passes.bloom,"strength",0,1),c.add(e.effects.passes.bloom,"radius",0,1),c.add(e.effects.passes.bloom,"threshold",0,1)}},{key:"tick",value:function(t){Yt(Zt(a.prototype),"tick",this).call(this,t);var e=Ct.clamp,n=Ct.lerp,r=this.sketch,o=this.tracker,i=this.projector,s=r.settings,l=e(s.lerpSpeed*t,0,1);if(this.trackerEnabled){var c=o.centerX;this.intensity=n(this.intensity,c,l),r.mesh.material.opacity=n(s.opacity.min,s.opacity.max,this.intensity),r.speed=n(s.speed.min,s.speed.max,this.intensity);var u=n(s.minCount,r.maxCount,o.centerY);r.mesh.count=n(r.mesh.count,u,l)}var f=s.targeted,h=f.delay,d=f.growth,p=f.decay;r.targeted.uniforms.opacity.value=r.mesh.material.opacity,i.set(o.polarizeX,o.reversePolarizeY),i.tick(t),this.cursorCurrent.set(o.x,o.y);var m=this.cursorCurrent.distanceTo(this.cursorPrevious);this.cursorPrevious.copy(this.cursorCurrent),r.activity=e(r.activity+m*d-p*t,0,1),r.baseDelay=Math.max(h.max-r.activity*h.max,h.min),r.delay=h.min+r.baseDelay,this.trackerEnabled&&this.refreshGUI()}}],r&&Lt(n.prototype,r),o&&Lt(n,o),Object.defineProperty(n,"prototype",{writable:!1}),a}(Ct),Qt={name:"Rain II",random:!0,instances:1e3,offsetY:-5,originZ:-10,maxAngle:2*Math.PI,ratio:1.2,spread:1.5,geometry:{innerRadius:.6,outerRadius:.72,thetaSegments:6},background:{color1:2490445,color2:26065},material:{color:6467070,transparent:!0},bloom:{strength:.8,radius:.7,threshold:.33},camera:{start:{x:0,y:10,z:10}},lerpSpeed:.001,opacity:{min:.7,max:1},speed:{min:2e-4,max:4e-4},minCount:100,instanceCount:1e3,cursorProjector:{horizontal:!0,cursorSize:.5,multiplier:1.5},targeted:{scatter:.8,spread:4,growth:10,decay:.001,scale:{min:.1,max:1.2},delay:{min:.004,max:1}}};const qt="float loopValue( float value, float minimum, float change ) {\r\n\r\n\treturn minimum + mod( value - minimum, change );\r\n\r\n}",Kt="//\tSimplex 3D Noise \n//\tby Ian McEwan, Ashima Arts\n//\nvec4 permute( vec4 x ){ return mod( ( ( x * 34.0 ) + 1.0 ) * x, 289.0 ); }\nvec4 taylorInvSqrt( vec4 r ){ return 1.79284291400159 - 0.85373472095314 * r; }\n\nfloat simplex3D( float vx, float vy, float vz ) {\n\n\tvec3 v = vec3( vx, vy, vz );\n\t\n\tconst vec2 C = vec2( 1.0/6.0, 1.0/3.0   );\n\tconst vec4 D = vec4( 0.0, 0.5, 1.0, 2.0 );\n\n\t// First corner\n\tvec3 i  = floor( v + dot( v, C.yyy ) );\n\tvec3 x0 =   v - i + dot( i, C.xxx ) ;\n\n\t// Other corners\n\tvec3 g = step( x0.yzx, x0.xyz );\n\tvec3 l = 1.0 - g;\n\tvec3 i1 = min(  g.xyz, l.zxy );\n\tvec3 i2 = max(  g.xyz, l.zxy );\n\n\t// x0 = x0 - 0. + 0.0 * C \n\tvec3 x1 = x0 - i1 + 1.0 * C.xxx;\n\tvec3 x2 = x0 - i2 + 2.0 * C.xxx;\n\tvec3 x3 = x0 - 1. + 3.0 * C.xxx;\n\n\t// Permutations\n\ti = mod( i, 289.0 ); \n\tvec4 p = permute( permute( permute(\n\t\t\t i.z + vec4( 0.0, i1.z, i2.z, 1.0 ) )\n\t\t   + i.y + vec4( 0.0, i1.y, i2.y, 1.0 ) ) \n\t\t   + i.x + vec4( 0.0, i1.x, i2.x, 1.0 ) );\n\n\t// Gradients\n\t// ( N*N points uniformly over a square, mapped onto an octahedron.)\n  \tfloat n_ = 1.0/7.0; // N=7\n  \tvec3  ns = n_ * D.wyz - D.xzx;\n\n  \tvec4 j = p - 49.0 * floor( p * ns.z *ns.z ); //  mod( p,N*N)\n\n  \tvec4 x_ = floor( j * ns.z );\n  \tvec4 y_ = floor( j - 7.0 * x_ ); // mod( j,N)\n\n  \tvec4 x = x_ *ns.x + ns.yyyy;\n  \tvec4 y = y_ *ns.x + ns.yyyy;\n  \tvec4 h = 1.0 - abs( x ) - abs( y );\n\n  \tvec4 b0 = vec4( x.xy, y.xy );\n  \tvec4 b1 = vec4( x.zw, y.zw );\n\n  \tvec4 s0 = floor( b0 )*2.0 + 1.0;\n  \tvec4 s1 = floor( b1 )*2.0 + 1.0;\n  \tvec4 sh = -step( h, vec4( 0.0 ) );\n\n  \tvec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  \tvec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  \tvec3 p0 = vec3( a0.xy,h.x );\n  \tvec3 p1 = vec3( a0.zw,h.y );\n  \tvec3 p2 = vec3( a1.xy,h.z );\n  \tvec3 p3 = vec3( a1.zw,h.w );\n\n\t// Normalise gradients\n  \tvec4 norm = taylorInvSqrt( \n\t\tvec4( dot( p0, p0 ), dot( p1, p1 ), dot( p2, p2 ), dot( p3, p3 ) )\n\t);\n  \tp0 *= norm.x;\n  \tp1 *= norm.y;\n  \tp2 *= norm.z;\n  \tp3 *= norm.w;\n\n\t// Mix final noise value\n  \tvec4 m = max( \n\t\t0.6 - vec4( dot( x0, x0 ), dot( x1, x1 ), dot( x2, x2 ), dot( x3, x3 ) ), \n\t\t0.0\n\t);\n  \tm = m * m;\n  \treturn 42.0 * dot( \n\t\tm*m,\n\t\tvec4( dot( p0,x0 ), dot( p1,x1 ), dot( p2,x2 ), dot( p3,x3 ) )\n\t);\n\n}";var Jt={parabola:"float parabola( float x, float power ) {\r\n\r\n\treturn pow( 4.0 * x * ( 1.0 - x ), power );\r\n\r\n}",rotateX:"mat3 rotateX( float angle ) {\r\n\treturn mat3(\r\n\t\tvec3(   1.0,\t        0.0,             0.0\t    ),\r\n\t\tvec3(   0.0, \t        cos(angle), \t-sin(angle) ),\r\n\t\tvec3(   0.0, \t        sin(angle), \t cos(angle) )\r\n\t);\r\n}",rotateY:"mat3 rotateY( float angle ) {\r\n\treturn mat3(\r\n\t\tvec3(   cos(angle),    0.0,           sin(angle)  ),\r\n\t\tvec3(   0.0,           1.0,           0.0         ),\r\n\t\tvec3(   -sin(angle),   0.0,           cos(angle)  )\r\n\t);\r\n}",rotateZ:"mat3 rotateZ( float angle ) {\r\n\treturn mat3(\r\n\t\tvec3(   cos(angle),   -sin(angle),     0.0   ),\r\n\t\tvec3(   sin(angle),    cos(angle),     0.0   ),\r\n\t\tvec3(   0.0,           0.0,            1.0   )\r\n\t);\r\n}",scale:"mat3 scale( float x, float y, float z ) {\r\n\treturn mat3(\r\n\t\tvec3(   x,      0.0,    0.0   ),\r\n\t\tvec3(   0.0,    y,      0.0   ),\r\n\t\tvec3(   0.0,    0.0,    z     )\r\n\t);\r\n}",bayerMatrixDither:G,linearGradient:Q,loopValue:qt,simplex3D:Kt,floatPack:o.glsl,getBase:function(){return{blending:t.NormalBlending,transparent:!0}},editBasic:function(t,e,n,r,o){var i="\n",a="#include <common>",s="#include <begin_vertex>",l="#include <logdepthbuf_fragment>";return e&&(t.vertexShader=t.vertexShader.replace(a,a+i+e)),n&&(t.vertexShader=t.vertexShader.replace(s,s+i+n)),r&&(t.fragmentShader=t.fragmentShader.replace(a,a+i+r)),o&&(t.fragmentShader=t.fragmentShader.replace(l,o+i+"\t"+l)),Jt.debug&&(console.log(t.vertexShader),console.log(t.fragmentShader)),t}},$t={};function te(t){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(t)}function ee(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ne(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function re(){return re="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=oe(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},re.apply(this,arguments)}function oe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=le(t)););return t}function ie(t,e){return ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ie(t,e)}function ae(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=le(t);if(e){var o=le(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return se(this,n)}}function se(t,e){if(e&&("object"===te(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function le(t){return le=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},le(t)}$t.edit=function(t){return Jt.editBasic(t,"\nattribute float aProgress;\nvarying float vProgress;\n","\n\tvProgress = aProgress;\n","\nvarying float vProgress;\n","\n\tdiffuseColor.a *= mod( 1.0 - vProgress, 1.0 );\n")},$t.impact=Jt.getBase(),$t.impact.vertexShader="\nattribute vec3 aOffset;\nattribute float aLife;\nuniform float uScaleMin;\nuniform float uScaleMax;\nvarying float vLife;\n\n".concat(Jt.rotateZ,"\n\nvoid main() {\n\n\tvLife = clamp( aLife, 0.0, 1.0 );\n\n\tvec3 transformed = aOffset + position * ( uScaleMin + vLife * uScaleMax );\n\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( transformed, 1.0 );\n\n}\n"),$t.impact.fragmentShader="\nuniform vec3 color;\nuniform float opacity;\nvarying float vLife;\n\nvoid main() {\n\n\tfloat dynamicOpacity = ( 1.0 - vLife ) * opacity;\n\n\tgl_FragColor = vec4( color, dynamicOpacity );\n\n}\n";var ce=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ie(t,e)}(a,e);var n,r,o,i=ae(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ee(this,a),(t=i.call(this,{defaults:Qt,settings:e})).y=t.settings.offsetY,t.speed=t.settings.speed.min,t.originZ=t.settings.originZ,t.simplex=new T(t.random),t.instance=0,t.counter=0,t.baseDelay=3,t.delay=1e-5,t.noise=0,t.activity=0,t}return n=a,r=[{key:"init",value:function(){this.effects.add("bloom",new N(this.settings.bloom)),re(le(a.prototype),"init",this).call(this,Wt),this.controls.projector.plane.position.set(0,this.y,0)}},{key:"initScene",value:function(){this.initRandomImpacts(),this.initTargetedImpacts()}},{key:"tick",value:function(t){if(!this.speed)return re(le(a.prototype),"tick",this).call(this,t);var e=this.speed*t;this.tickRandom(e),this.tickCursor(e),re(le(a.prototype),"tick",this).call(this,t)}},{key:"initRandomImpacts",value:function(){var e=this.settings.geometry,n=e.innerRadius,r=e.outerRadius,o=e.thetaSegments,i=new t.RingGeometry(n,r,o);i.rotateX(-Math.PI/2);var a=new t.MeshBasicMaterial(this.settings.material);a.onBeforeCompile=$t.edit;var s=this.settings.instances;this.mesh=new t.InstancedMesh(i,a,s),this.add(this.mesh),this.dummy=new t.Object3D;var l=new Float32Array(s);this.x=new Float32Array(s),this.z=new Float32Array(s);for(var c=0;c<s;c++){this.randomizePositionAt(c);var u=this.random.amount();this.dummy.scale.set(u,u,u),l[c]=u,this.dummy.updateMatrix(),this.mesh.setMatrixAt(c,this.dummy.matrix)}i.setAttribute("aProgress",new t.InstancedBufferAttribute(l,1)),this.mesh.instanceMatrix.setUsage(t.DynamicDrawUsage),this.mesh.count=this.maxCount}},{key:"randomizePositionAt",value:function(t){var e=this.random.number(0,this.settings.maxAngle);this.dummy.position.set(Math.cos(e)*this.random.amount()*this.width,this.y,Math.sin(e)*this.random.amount()*this.depth+this.settings.originZ),this.x[t]=this.dummy.position.x,this.z[t]=this.dummy.position.z}},{key:"updateAspect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.camera.aspect;this.maxCount=this.settings.instances,this.maxCount=t<1?Math.round(this.settings.instances*t):this.settings.instances,this.width=j.getVisibleWidth(this.camera,this.settings.originZ)*this.settings.spread,this.depth=this.width*this.settings.ratio/t}},{key:"resize",value:function(t,e,n){re(le(a.prototype),"resize",this).call(this,t,e,n),this.updateAspect()}},{key:"tickRandom",value:function(t){for(var e=this.mesh.geometry.attributes.aProgress.array,n=0;n<this.mesh.count;n++){var r=e[n]+t;r>1?(r=0,this.randomizePositionAt(n)):this.dummy.position.set(this.x[n],this.y,this.z[n]),this.dummy.scale.set(r,r,r),this.dummy.updateMatrix(),this.mesh.setMatrixAt(n,this.dummy.matrix),e[n]=r}this.mesh.instanceMatrix.needsUpdate=!0,this.mesh.geometry.attributes.aProgress.needsUpdate=!0}},{key:"initTargetedImpacts",value:function(){var e=this.settings,n=new t.CircleGeometry(e.outerRadius,6);n.rotateX(-Math.PI/2);var r=new t.EdgesGeometry(n),o=e.instanceCount,i=new t.InstancedBufferGeometry;i.instanceCount=o;for(var a=3*o,s=new Float32Array(a),l=0;l<a;l+=3)s[l]=-100,s[l+2]=-100;i.setAttribute("position",(new t.Float32BufferAttribute).copy(r.attributes.position)),i.setAttribute("aOffset",new t.InstancedBufferAttribute(s,3)),i.setAttribute("aLife",new t.InstancedBufferAttribute(new Float32Array(o).fill(1),1)),this.targeted={geometry:i},this.targeted.uniforms={uScaleMin:new t.Uniform(e.targeted.scale.min),uScaleMax:new t.Uniform(e.targeted.scale.max),color:new t.Uniform(new t.Color(e.material.color)),opacity:new t.Uniform(1)},$t.impact.uniforms=this.targeted.uniforms;var c=new t.ShaderMaterial($t.impact);this.cursorImpacts=new t.LineSegments(i,c),this.cursorImpacts.position.set(0,this.y,0),this.add(this.cursorImpacts)}},{key:"generateAt",value:function(t){var e=this.random,n=this.settings.targeted,r=n.scatter,o=n.spread,i=this.targeted.geometry.attributes,a=i.aOffset,s=i.aLife,l=e.chance(r),c=l?t.x+e.noise()*o*this.activity:t.x,u=l?t.z+e.noise()*o*this.activity:t.z,f=3*this.instance;a.array[f]=c,a.array[f+2]=u,s.array[this.instance]=0,this.instance=(this.instance+1)%this.settings.instanceCount,a.needsUpdate=!0}},{key:"tickCursor",value:function(t){if(this.counter+=t,this.counter>this.delay){var e=this.controls.cursor.position;this.generateAt(e),this.noise=this.simplex.noise3D(e.x,e.y,this.counter),this.counter=0}for(var n=0;n<this.settings.instanceCount;n++)this.targeted.geometry.attributes.aLife.array[n]+=t;this.targeted.geometry.attributes.aLife.needsUpdate=!0}}],r&&ne(n.prototype,r),o&&ne(n,o),Object.defineProperty(n,"prototype",{writable:!1}),a}(Dt);function ue(t){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue(t)}function fe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function he(){return he="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=de(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},he.apply(this,arguments)}function de(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ye(t)););return t}function pe(t,e){return pe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},pe(t,e)}function me(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ye(t);if(e){var o=ye(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ve(this,n)}}function ve(t,e){if(e&&("object"===ue(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ye(t){return ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ye(t)}var be=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pe(t,e)}(i,t);var e,n,r,o=me(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,t)).amplitude=.5,e.intensity=.5,e.orbit=new Bt(t.camera,t.sketchpad.canvas),e.orbit.enabled=!1,e}return e=i,n=[{key:"initTracker",value:function(){this.tracker=new bt({margin:.2}),this.trackerEnabled=!1}},{key:"initGUI",value:function(){var t=this;he(ye(i.prototype),"initGUI",this).call(this);var e=this.gui,n=this.sketch,r=n.settings,o=Ct.VALUE,a=e.addFolder("Grid").onFinishChange((function(){return n.rebuild()}));a.add(r.tiles,"x",1,400).step(1).name("columns"),a.add(r.tiles,"z",10,400).step(1).name("rows"),a.add(r.tiles,"width",.1,20),a.add(r.tiles,"depth",.1,20);var s=e.addFolder("Animation");s.add(n.amp,o,.1,5).name("amplifier"),s.add(n.noiseScale.value,"x",.001,1).name("noiseScale.x"),s.add(n.noiseScale.value,"y",.001,1).name("noiseScale.y"),s.add(n.noiseScale.value,"z",.001,1).name("noiseScale.z"),s.add(this,"trackerEnabled").name("cursorTracker"),s.add(this,"cameraRigEnabled").name("cameraRig").onChange((function(){return t.orbit.enabled=!t.cameraRigEnabled}));var l=e.addFolder("Colors");l.addColor(n.background,"color1").name("background1"),l.addColor(n.background,"color2").name("background2"),l.addColor(n.color,o).name("grid");var c=e.addFolder("Bloom").close();c.add(n.effects.passes.bloom,"strength",0,1),c.add(n.effects.passes.bloom,"radius",0,1),c.add(n.effects.passes.bloom,"threshold",0,1)}},{key:"tick",value:function(t){var e=Ct.clamp,n=Ct.lerp,r=this.sketch,o=this.tracker,i=r.settings,a=e(i.lerpSpeed*t,0,1);if(this.cameraRigEnabled&&this.cameraRig.update(o.reversePolarizeX,o.y).tick(t),this.trackerEnabled){var s=o.x;this.amplitude=n(this.amplitude,s,a);var l=r.noiseScale.value;l.x=n(i.noiseScaleX.min,i.noiseScaleX.max,this.amplitude),l.y=n(i.noiseScaleY.min,i.noiseScaleY.max,this.amplitude),r.amp.value=n(i.amp.min,i.amp.max,this.amplitude);var c=o.reverseY;this.intensity=n(this.intensity,c,a),r.opacity.value=n(i.opacity.min,i.opacity.max,this.intensity),i.speed.value=n(i.speed.min,i.speed.max,this.intensity),this.refreshGUI()}}}],n&&fe(e.prototype,n),r&&fe(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ct),ge={name:"Navscan",background:{color1:16015,color2:6815877},grid:{color:16734254,opacity:.8,z:10},tiles:{x:400,z:200,width:.4,depth:.4},camera:{start:{x:0,y:0,z:5},lookAt:{x:0,y:0,z:-5},intro:{x:0,y:-5,z:5}},cameraRig:{bounds:{x:5,y:10,z:0},speed:.0012},bloom:{strength:.8,radius:.8,threshold:.25},lerpSpeed:7e-4,noiseScaleX:{min:.01,max:.25},noiseScaleY:{min:0,max:.1},amp:{min:1,max:2.5},opacity:{min:.4,max:.8},speed:{min:.004,max:.012,value:.01}},we=Jt.getBase();function xe(t){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xe(t)}function Pe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Oe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ke(){return ke="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Se(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},ke.apply(this,arguments)}function Se(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=je(t)););return t}function Ce(t,e){return Ce=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ce(t,e)}function Te(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=je(t);if(e){var o=je(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _e(this,n)}}function _e(t,e){if(e&&("object"===xe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function je(t){return je=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},je(t)}we.vertexShader="\nuniform float uAmp;\nuniform float uDistance;\nuniform float uTileDepth;\nuniform vec3 uNoiseScale;\n\n".concat(Jt.simplex3D,"\n\nvoid main() {\n\n\tvec3 transformed = position;\n\n\t// Z\n\ttransformed.z += mod( uDistance, uTileDepth );\n\n\t// Y\n\tfloat x = position.x;\n\tfloat z = uDistance - transformed.z;\n\tfloat noise = simplex3D( \n\t\tx * uNoiseScale.x,\n\t\tmod( x, 2.0 ) * uNoiseScale.y,\n\t\tz * uNoiseScale.z\n\t);\n\n\tfloat largeNoise = uAmp * (\n\t\tsimplex3D( x * 0.03, z * 0.03, uNoiseScale.x ) * 0.7 - 1.0\n\t);\n\n\ttransformed.y = uAmp * ( clamp( noise * uAmp, -0.3, 0.3 ) + largeNoise );\n\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( transformed, 1.0 );\n\n}\n"),we.fragmentShader="\nuniform vec3 color;\nuniform float opacity;\n\nvoid main() {\n\n\tgl_FragColor = vec4( color, opacity );\n\n}\n";var ze=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ce(t,e)}(a,e);var n,r,o,i=Te(a);function a(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Pe(this,a),n=(e=i.call(this,{defaults:ge,settings:n})).settings,e.amp=new t.Uniform(2),e.distance=new t.Uniform(0),e.tileDepth=new t.Uniform(n.tiles.depth),e.noiseScale=new t.Uniform(new t.Vector3(.1,.03,.07)),e.color=new t.Uniform(new t.Color(n.grid.color)),e.opacity=new t.Uniform(n.grid.opacity),e}return n=a,(r=[{key:"init",value:function(){this.effects.add("bloom",new N(this.settings.bloom)),ke(je(a.prototype),"init",this).call(this,be)}},{key:"initScene",value:function(){var e=this.settings,n=-e.tiles.x*e.tiles.width/2,r=-e.tiles.z*e.tiles.depth,o=e.tiles.x+1,i=e.tiles.z+1,a=e.tiles.x*e.tiles.z,s=o*i,l=8*a;this.debug&&console.log({points:s,tiles:a});for(var c=new Float32Array(3*l),u=new Float32Array(s),f=new Float32Array(s),h=0,d=0,p=0,m=0,v=0;v<s;v++)u[h++]=n+e.tiles.width*p,f[d++]=r+e.tiles.depth*m,0==(p=(p+1)%o)&&m++;var y,b,g,w,x=0,P=0,O=0;p=0,m=0;for(var k=function(t){c[x++]=u[t],c[x++]=0,c[x++]=f[t]},S=function(t,e){k(t),k(e)},C=0;C<a;C++)w=(g=C+o+O)+1,S(y=C+O,b=y+1),S(b,w),S(w,g),S(g,y),0==(P=(P+1)%e.tiles.x)&&O++;var T=new t.BufferGeometry;T.setAttribute("position",new t.Float32BufferAttribute(c,3)),we.uniforms={color:this.color,opacity:this.opacity,uAmp:this.amp,uDistance:this.distance,uNoiseScale:this.noiseScale,uTileDepth:this.tileDepth};var _=new t.ShaderMaterial(we),j=new t.LineSegments(T,_);j.position.set(0,0,e.grid.z),this.add(j),this.grid=j}},{key:"tick",value:function(t){this.distance.value+=this.settings.speed.value*t,ke(je(a.prototype),"tick",this).call(this,t)}},{key:"clear",value:function(){this.remove(this.grid),this.grid.geometry.dispose(),this.grid.material.dispose()}},{key:"rebuild",value:function(){this.clear(),this.tileDepth.value=this.settings.tiles.depth,this.initScene()}}])&&Oe(n.prototype,r),o&&Oe(n,o),Object.defineProperty(n,"prototype",{writable:!1}),a}(Dt),Ee=.05,Re={name:"Blockflow",tile:{countX:40,countZ:40,width:.3,height:.1,depth:.3,margin:{x:Ee,y:0,z:Ee}},border:.875,background:{color1:38323,color2:39270},colorLow:51414,colorHigh:13362688,bloom:{strength:.2,radius:.7,threshold:.5},camera:{start:{x:10,y:15,z:10}},cursorProjector:{horizontal:!0,cursorSize:.5,lerp:.007,multiplier:1.5},lerpSpeed:7e-4,speed:{min:2.5,max:3.5,value:3},amplitude:{min:150,max:250,value:200},scale:{min:.2,max:.8,value:.5},thickness:{min:.5,max:1.5,value:1},turbulence:{min:.2,max:1.5,value:1},opacity:{min:.4,max:.6,value:.5}};function Me(t){return Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Me(t)}function Ue(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function De(){return De="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Ae(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},De.apply(this,arguments)}function Ae(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ie(t)););return t}function Ge(t,e){return Ge=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ge(t,e)}function Fe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ie(t);if(e){var o=Ie(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Be(this,n)}}function Be(t,e){if(e&&("object"===Me(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ie(t){return Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ie(t)}var Le=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ge(t,e)}(i,t);var e,n,r,o=Fe(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,t)).amplitude=.5,e.intensity=.5,e.updateProjectorBounds(),e.trackerEnabled=!1,e.orbit=new Bt(t.camera,t.sketchpad.canvas),e}return e=i,n=[{key:"updateProjectorBounds",value:function(){var t=this.sketch.settings.cursorProjector.multiplier,e=.5*this.sketch.width*t,n=.5*this.sketch.depth*t;this.projector.bounds={x:{min:-e,max:e},z:{min:-n,max:n}}}},{key:"initGUI",value:function(){De(Ie(i.prototype),"initGUI",this).call(this);var t=this.gui,e=this.sketch,n=e.settings,r=e.material.uniforms,o=e.effects.passes,a=Ct.VALUE,s=t.addFolder("Grid").onFinishChange((function(){return e.rebuild()}));s.add(n.tile,"countX",1,100).step(1).name("columns"),s.add(n.tile,"countZ",1,100).step(1).name("rows"),s.add(n.tile,"width",.1,1).name("tile width"),s.add(n.tile,"depth",.1,1).name("tile depth"),s.add(n.tile.margin,"x",0,1).name("margin width"),s.add(n.tile.margin,"z",0,1).name("margin depth"),s.add(n.tile,"height",.01,.5).name("base height"),s.add(e.border,"visible").name("border");var l=t.addFolder("Animation");l.add(n.speed,a,1,10).name("speed").onFinishChange((function(){return e.setSpeed()})),l.add(r.uAmplitude,a,1,300).name("amplitude"),l.add(r.uThickness,a,0,4).name("thickness"),l.add(r.uTurbulence,a,0,5).name("turbulence"),l.add(r.uScale,a,0,1).name("scale"),l.add(this,"trackerEnabled").name("cursorTracker").listen();var c=t.addFolder("Colors");c.addColor(e.background,"color1").name("background high"),c.addColor(e.background,"color2").name("background low"),c.addColor(r.uColorHigh,a).name("grid high"),c.addColor(r.uColorLow,a).name("grid low"),c.add(r.opacity,a,.1,1).name("opacity");var u=t.addFolder("Bloom").close();u.add(o.bloom,"strength",0,1),u.add(o.bloom,"radius",0,1),u.add(o.bloom,"threshold",0,1)}},{key:"tick",value:function(t){De(Ie(i.prototype),"tick",this).call(this,t);var e=this.sketch,n=this.tracker,r=this.projector,o=e.settings,a=Ct.clamp,s=Ct.lerp;if(r.set(n.polarizeX,n.reversePolarizeY),r.tick(t),r.cursor.position.x=a(r.cursor.position.x,r.bounds.x.min,r.bounds.x.max),r.cursor.position.z=a(r.cursor.position.z,r.bounds.z.min,r.bounds.z.max),this.trackerEnabled){var l=a(o.lerpSpeed*t,0,1);this.amplitude=s(this.amplitude,n.reverseY,l),e.amplitude.value=s(o.amplitude.min,o.amplitude.max,this.amplitude),e.opacity.value=s(o.opacity.max,o.opacity.min,this.amplitude),o.speed.value=s(o.speed.min,o.speed.max,this.amplitude),e.setSpeed(),this.intensity=s(this.intensity,n.x,l),e.scale.value=s(o.scale.min,o.scale.max,this.intensity),e.thickness.value=s(o.thickness.max,o.thickness.min,this.intensity),e.turbulence.value=s(o.turbulence.min,o.turbulence.max,this.intensity),this.refreshGUI()}}}],n&&Ue(e.prototype,n),r&&Ue(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ct),Ye=Jt.getBase();function Xe(t){return Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xe(t)}function Ve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ne(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function He(){return He="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Ze(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},He.apply(this,arguments)}function Ze(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ke(t)););return t}function We(t,e){return We=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},We(t,e)}function Qe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ke(t);if(e){var o=Ke(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qe(this,n)}}function qe(t,e){if(e&&("object"===Xe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ke(t){return Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ke(t)}Ye.vertexShader="\nattribute vec3 aOffset;\nuniform float uAmplitude;\nuniform float uScale;\nuniform float uTime;\nuniform float uThickness;\nuniform float uTurbulence;\nuniform vec3 uCursor;\nvarying float vHeight;\n\n".concat(Jt.simplex3D,"\n\nvoid main() {\n\n\tvec3 transformed = position + aOffset;\n\n\tfloat distanceToCursor = length( uCursor - aOffset );\n\tfloat force = - 1.0 / ( 1.618 + sqrt( distanceToCursor ) );\n\n\tfloat waves = simplex3D(\n\t\tuScale * 0.02 * aOffset.x, \n\t\tdistanceToCursor * 0.1 - uTime,\n\t\tuScale * 0.02 * aOffset.z\n\t) * force * 8.0;\n\n\tfloat turbulence = simplex3D(\n\t\taOffset.x * uScale,\n\t\taOffset.z * uScale,\n\t\tuTime\n\t) * uTurbulence;\n\n\tfloat noise = abs( uThickness + waves + turbulence );\n\n\ttransformed.y *= position.y * noise * uAmplitude;\n\n\tvHeight = transformed.y;\n\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( transformed, 1.0 );\n\n}\n"),Ye.fragmentShader="\nuniform float opacity;\nuniform vec3 uColorLow;\nuniform vec3 uColorHigh;\nvarying float vHeight;\n\nvoid main() {\n\n\tvec3 dynamicColor = mix( uColorLow, uColorHigh, vHeight );\n\n\tgl_FragColor = vec4( dynamicColor, opacity );\n\n}\n";var Je=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&We(t,e)}(a,e);var n,r,o,i=Qe(a);function a(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Ve(this,a),n=(e=i.call(this,{defaults:Re,settings:n})).settings,e.cursor=new t.Uniform(null),e.amplitude=new t.Uniform(n.amplitude.value),e.scale=new t.Uniform(n.scale.value),e.thickness=new t.Uniform(n.thickness.value),e.turbulence=new t.Uniform(n.turbulence.value),e.time=new t.Uniform(0),e.opacity=new t.Uniform(n.opacity.value),e.colorLow=new t.Uniform(new t.Color(n.colorLow)),e.colorHigh=new t.Uniform(new t.Color(n.colorHigh)),e.setSpeed(),e}return n=a,r=[{key:"init",value:function(){this.effects.add("bloom",new N(this.settings.bloom)),He(Ke(a.prototype),"init",this).call(this,Le),this.cursor.value=this.controls.cursor.position}},{key:"initScene",value:function(){var e=this.settings,n=e.tile,r=n.countX*n.countZ,o=n.width+n.margin.x,i=n.depth+n.margin.z;this.width=o*n.countX-n.margin.x,this.depth=i*n.countZ-n.margin.z;var a=-(this.width-n.width)/2,s=.5*-n.height,l=-(this.depth-n.depth)/2;this.debug&&console.log({instances:r});for(var c=new t.BoxGeometry(n.width,n.height,n.depth),u=new t.EdgesGeometry(c),f=new Float32Array(u.attributes.position.array),h=3*r,d=new Float32Array(h),p=0,m=0,v=0;v<h;v+=3)d[v]=a+p*o,d[v+1]=s,d[v+2]=l+m*i,0==(p=(p+1)%n.countX)&&m++;var y=new t.InstancedBufferGeometry;y.instanceCount=r,y.setAttribute("position",new t.Float32BufferAttribute(f,3)),y.setAttribute("aOffset",new t.InstancedBufferAttribute(d,3)),Ye.uniforms={uCursor:this.cursor,uAmplitude:this.amplitude,uScale:this.scale,uThickness:this.thickness,uTurbulence:this.turbulence,uTime:this.time,opacity:this.opacity,uColorLow:this.colorLow,uColorHigh:this.colorHigh};var b=new t.ShaderMaterial(Ye);this.grid=new t.LineSegments(y,b),this.add(this.grid);var g=new t.PlaneGeometry(this.width+e.border,this.depth+e.border);g.rotateX(-Math.PI/2),this.border=new t.LineSegments(new t.EdgesGeometry(g),b),this.add(this.border),this.geometry=y,this.material=b,c.dispose(),u.dispose(),g.dispose()}},{key:"tick",value:function(t){this.time.value+=t*this.speed,He(Ke(a.prototype),"tick",this).call(this,t)}},{key:"setSpeed",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.settings.speed.value,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-4;this.speed=t*e}},{key:"clear",value:function(){this.remove(this.grid),this.geometry.dispose(),this.material.dispose(),this.remove(this.border),this.border.geometry.dispose(),this.border.material.dispose()}},{key:"rebuild",value:function(){this.clear(),this.initScene(),this.controls.updateProjectorBounds()}}],r&&Ne(n.prototype,r),o&&Ne(n,o),Object.defineProperty(n,"prototype",{writable:!1}),a}(Dt);const $e="\nuniform sampler2D GPGPU_x;\nuniform sampler2D GPGPU_y;\nuniform sampler2D GPGPU_z;\nuniform float uEpsilon;\nuniform float uCurlScale;\nuniform float uCurlSpeed;\nuniform float uDelta;\nuniform float uTime;\nuniform vec3 uBounds;\nuniform vec3 uCurlStrength;\nuniform vec3 uWind;\n".concat(o.glsl,"\n").concat(qt,"\n").concat(Kt,"\n\nvoid main() {\n\t\n\t// Read\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\tfloat x = unpackFloat( texture2D( GPGPU_x, uv ) );\n\tfloat y = unpackFloat( texture2D( GPGPU_y, uv ) );\n\tfloat z = unpackFloat( texture2D( GPGPU_z, uv ) );\n\n\t// Curl\n\n\tfloat scaledX = ( x + uTime ) * uCurlScale;\n\tfloat scaledY = ( y + uTime ) * uCurlScale;\n\tfloat scaledZ = ( z + uTime ) * uCurlScale;\n\n\tfloat noiseY1 = simplex3D( scaledX, scaledY + uEpsilon, scaledZ );\n\tfloat noiseY2 = simplex3D( scaledX, scaledY - uEpsilon, scaledZ );\n\tfloat noiseY = noiseY1 - noiseY2;\n\n\tfloat noiseZ1 = simplex3D( scaledX, scaledY, scaledZ + uEpsilon );\n\tfloat noiseZ2 = simplex3D( scaledX, scaledY, scaledZ - uEpsilon );\n\tfloat noiseZ = noiseZ1 - noiseZ2;\n\n\t// epsilon * 2 division applied in uCurlSpeed to save calculations\n\tfloat curl = ( noiseY - noiseZ ) * uCurlSpeed;\n\n\t// Write\n\n\tfloat wind =  uWind.x + simplex3D( uTime, uv.x * 0.1, uv.y * 0.1 );\n\tfloat noise = mix( wind, curl, uCurlStrength.x ) + uWind.x;\n\tx = mix( x, x + noise, uDelta );\n\tx = loopValue( x, uBounds.x, uBounds.z );\n\n\tgl_FragColor = packFloat( x );\n\n}\n"),tn="\nuniform sampler2D GPGPU_x;\nuniform sampler2D GPGPU_y;\nuniform sampler2D GPGPU_z;\nuniform float uCurlScale;\nuniform float uCurlSpeed;\nuniform float uDelta;\nuniform float uEpsilon;\nuniform vec3 uBounds;\nuniform vec3 uCurlStrength;\nuniform vec3 uWind;\n".concat(o.glsl,"\n").concat(qt,"\n").concat(Kt,"\n\nvoid main() {\n\t\n\t// Read\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\tfloat x = unpackFloat( texture2D( GPGPU_x, uv ) );\n\tfloat y = unpackFloat( texture2D( GPGPU_y, uv ) );\n\tfloat z = unpackFloat( texture2D( GPGPU_z, uv ) );\n\n\t// Curl\n\n\tfloat scaledX = x * uCurlScale;\n\tfloat scaledY = y * uCurlScale;\n\tfloat scaledZ = z * uCurlScale;\n\n\tfloat noiseZ1 = simplex3D( scaledX, scaledY, scaledZ + uEpsilon );\n\tfloat noiseZ2 = simplex3D( scaledX, scaledY, scaledZ - uEpsilon );\n\tfloat noiseZ = noiseZ1 - noiseZ2;\n\n\tfloat noiseX1 = simplex3D( scaledX + uEpsilon, scaledY, scaledZ );\n\tfloat noiseX2 = simplex3D( scaledX - uEpsilon, scaledY, scaledZ );\n\tfloat noiseX = noiseX1 - noiseX2;\n\n\tfloat curl = ( noiseZ - noiseX ) * uCurlSpeed;\n\n\t// Write\n\n\tfloat noise = mix( uWind.y, curl, uCurlStrength.y ) + uWind.y;\n\ty = mix( y, y + noise, uDelta );\n\ty = loopValue( y, uBounds.x, uBounds.z );\n\n\tgl_FragColor = packFloat( y );\n\n}\n"),en="\nuniform sampler2D GPGPU_x;\nuniform sampler2D GPGPU_y;\nuniform sampler2D GPGPU_z;\nuniform float uCurlScale;\nuniform float uCurlSpeed;\nuniform float uDelta;\nuniform float uEpsilon;\nuniform vec3 uBounds;\nuniform vec3 uCurlStrength;\nuniform vec3 uWind;\n".concat(o.glsl,"\n").concat(qt,"\n").concat(Kt,"\n\nvoid main() {\n\t\n\t// Read\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\tfloat x = unpackFloat( texture2D( GPGPU_x, uv ) );\n\tfloat y = unpackFloat( texture2D( GPGPU_y, uv ) );\n\tfloat z = unpackFloat( texture2D( GPGPU_z, uv ) );\n\n\t// Curl\n\n\tfloat scaledX = x * uCurlScale;\n\tfloat scaledY = y * uCurlScale;\n\tfloat scaledZ = z * uCurlScale;\n\n\tfloat noiseX1 = simplex3D( scaledX + uEpsilon, scaledY, scaledZ );\n\tfloat noiseX2 = simplex3D( scaledX - uEpsilon, scaledY, scaledZ );\n\tfloat noiseX = noiseX1 - noiseX2;\n\n\tfloat noiseY1 = simplex3D( scaledX, scaledY + uEpsilon, scaledZ );\n\tfloat noiseY2 = simplex3D( scaledX, scaledY - uEpsilon, scaledZ );\n\tfloat noiseY = noiseY1 - noiseY2;\n\n\tfloat curl = ( noiseX - noiseY ) * uCurlSpeed;\n\n\t// Write\n\n\tfloat noise = curl * uCurlStrength.z * uWind.z;\n\tz = mix( z, z + noise, uDelta );\n\tz = clamp( z, uBounds.x, uBounds.y );\n\n\tgl_FragColor = packFloat( z );\n\n}\n");var nn={};function rn(t){return rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rn(t)}function on(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function an(){return an="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=sn(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},an.apply(this,arguments)}function sn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=fn(t)););return t}function ln(t,e){return ln=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ln(t,e)}function cn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=fn(t);if(e){var o=fn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return un(this,n)}}function un(t,e){if(e&&("object"===rn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function fn(t){return fn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},fn(t)}nn.GPGPU_x=$e,nn.GPGPU_y=tn,nn.GPGPU_z=en,nn.material=Jt.getBase(),nn.material.vertexShader="\nattribute float aNoise;\nattribute vec2 GPGPU_target;\nuniform float uRotation;\nuniform float uTime;\nuniform sampler2D GPGPU_x;\nuniform sampler2D GPGPU_y;\nuniform sampler2D GPGPU_z;\nuniform vec3 uBounds;\nuniform vec3 uScale;\nvarying float vAltitude;\n\n".concat(Jt.rotateZ,"\n").concat(Jt.floatPack,"\n\nvoid main() {\n\n\tfloat translateX = unpackFloat( texture2D( GPGPU_x, GPGPU_target ) );\n\tfloat translateY = unpackFloat( texture2D( GPGPU_y, GPGPU_target ) );\n\tfloat translateZ = unpackFloat( texture2D( GPGPU_z, GPGPU_target ) );\n\n\tvAltitude = mix( 1.0, 0.0, ( translateY - uBounds.x ) / uBounds.z );\n\t\n\tfloat scale = mix( \n\t\tuScale.x,\n\t\tuScale.y,\n\t\tvAltitude * mix( uScale.z, 1.0, aNoise )\n\t);\n\n\tvec3 transformed = position;\n\ttransformed *= scale * rotateZ( uTime * uRotation * aNoise );\n\ttransformed += vec3( translateX, translateY, translateZ );\n\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( transformed, 1.0 );\n\n}\n"),nn.material.fragmentShader="\nuniform float opacity;\nuniform vec3 uColorLow;\nuniform vec3 uColorHigh;\nvarying float vAltitude;\n\nvoid main() {\n\n\tvec3 dynamicColor = mix( uColorHigh, uColorLow, vAltitude );\n\n\tgl_FragColor = vec4( dynamicColor, opacity );\n\n}\n";var hn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ln(t,e)}(i,t);var e,n,r,o=cn(i);function i(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,t)).tracker.x=1,e.orientation=1,e.intensity=.5;var n=t.settings.curl;return e.applyCurlSpeed=function(){t.curlSpeed.value=n.speed/(2*n.epsilon)},e.trackerEnabled=!1,e}return e=i,n=[{key:"initGUI",value:function(){var t=this;an(fn(i.prototype),"initGUI",this).call(this);var e=this.gui,n=this.sketch,r=n.settings,o=n.background,a=n.effects.passes,s=nn.material.uniforms,l=Ct.VALUE;e.add(this,"trackerEnabled").name("cursorTracker").listen(),e.add(n.core,"visible").name("core");var c=e.addFolder("Curl Noise");c.add(r.curl,"speed",.01,.5).onChange((function(){return t.applyCurlSpeed()})),c.add(n.curlScale,l,.01,2).name("scale"),c.add(n.curlStrength.value,"x",0,1).name("strength.x"),c.add(n.curlStrength.value,"y",0,1).name("strength.y"),c.add(n.curlStrength.value,"z",0,1).name("strength.z");var u=e.addFolder("Wind");u.add(n.wind.value,"x",-1.5,1.5),u.add(n.wind.value,"y",-1.5,1.5),u.add(n.wind.value,"z",-10,10);var f=e.addFolder("Animation");f.add(r,"speed",1e-4,.002),f.add(s.uRotation,l,0,360).step(1).name("rotation"),f.add(s.uScale.value,"x",0,1).name("scale.top"),f.add(s.uScale.value,"y",0,1).name("scale.bottom"),f.add(s.uScale.value,"z",0,1).name("scale.gradient");var h=e.addFolder("Colors");h.addColor(o,"color1").name("background high"),h.addColor(o,"color2").name("background low"),h.addColor(s.uColorHigh,l).name("particle high"),h.addColor(s.uColorLow,l).name("particle low");var d=e.addFolder("Bloom").close();d.add(a.bloom,"strength",0,1),d.add(a.bloom,"radius",0,1),d.add(a.bloom,"threshold",0,1)}},{key:"tick",value:function(t){if(this.trackerEnabled){var e=Ct.clamp,n=Ct.lerp,r=this.sketch,o=this.tracker,i=e(r.settings.lerpSpeed*t,0,1);this.orientation=n(this.orientation,o.polarizeX,i),this.intensity=n(this.intensity,o.reverseY,i),r.wind.value.x=.7*this.orientation,r.wind.value.y=n(.2,.5,this.intensity),r.wind.value.z=n(-3.5,3.5,this.intensity),this.sketch.settings.speed=n(6e-4,.0018,this.intensity),r.settings.curl.speed=n(.12,.04,this.intensity),this.applyCurlSpeed(),this.refreshGUI()}}}],n&&on(e.prototype,n),r&&on(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ct),dn={name:"Ablaze",background:{color1:11010090,color2:14505216},colorHigh:13395456,colorLow:16755200,opacity:.9,particle:{count:1e4,size:.04,near:-2,far:-5},disc:{size:.6,segments:64,offset:-1.5,fill:{color:0,opacity:.05,transparent:!0},stroke:{color:13395456,opacity:.1,transparent:!0}},curl:{epsilon:.001,speed:.07,scale:.3,strength:{x:.5,y:.33,z:.5}},rotation:90,scale:{top:0,bottom:1,gradient:.5},GPGPUTextureSize:128,speed:.001,timeFactor:.03,lerpSpeed:.0015,bloom:{strength:.55,radius:.4,threshold:.455},random:!0};function pn(t){return pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pn(t)}function mn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function vn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?mn(Object(n),!0).forEach((function(e){yn(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function yn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wn(){return wn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=xn(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},wn.apply(this,arguments)}function xn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Sn(t)););return t}function Pn(t,e){return Pn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Pn(t,e)}function On(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Sn(t);if(e){var o=Sn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kn(this,n)}}function kn(t,e){if(e&&("object"===pn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Sn(t){return Sn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Sn(t)}var Cn=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pn(t,e)}(a,e);var n,r,o,i=On(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return bn(this,a),(t=i.call(this,{defaults:dn,settings:e})).bounds=new j(t.camera,t.settings.particle.near,t.settings.particle.far),t}return n=a,r=[{key:"init",value:function(){this.effects.add("bloom",new N(this.settings.bloom)),wn(Sn(a.prototype),"init",this).call(this,hn)}},{key:"initScene",value:function(){var e=this.random,n=this.settings,r=new t.Group;this.add(r),this.core=r;var o=new t.CircleGeometry(n.disc.size,n.disc.segments),i=new t.MeshBasicMaterial(n.disc.fill),a=new t.Mesh(o,i);a.position.z=n.particle.near+n.disc.offset,r.add(a);var s=new t.EdgesGeometry(o),l=new t.LineBasicMaterial(n.disc.stroke),c=new t.LineSegments(s,l);c.position.copy(a.position),r.add(c);var u=n.GPGPUTextureSize,f=u*u,h=new t.CircleGeometry(n.particle.size,3);h.rotateZ(Math.PI/2);var d=new t.EdgesGeometry(h),p=new Float32Array(f),m=new Float32Array(f),v=new Float32Array(f),y=new Float32Array(2*f),b=new Float32Array(f);this.bounds.update();for(var g=this.bounds,w=g.left,x=g.right,P=g.bottom,O=g.top,k=g.near,S=g.far,C=0,T=0;C<f;C++)p[C]=e.number(w,x),m[C]=e.number(P,O),v[C]=e.number(k,S),y[T++]=C%u/u,y[T++]=~~(C/u)/u,b[C]=e.noise();var _=new t.InstancedBufferGeometry;_.instanceCount=f,_.setAttribute("position",(new t.Float32BufferAttribute).copy(d.attributes.position)),_.setAttribute("GPGPU_target",new t.InstancedBufferAttribute(y,2)),_.setAttribute("aNoise",new t.InstancedBufferAttribute(b,1)),this.particleCountMax=f,this.particleCountMin=Math.round(.1*f),this.initUniforms(p,m,v);var j=new t.ShaderMaterial(nn.material),z=new t.LineSegments(_,j);z.frustumCulled=!1,this.particles=z,this.add(z),this.updateInstanceCount(),h.dispose(),d.dispose()}},{key:"initUniforms",value:function(e,n,r){var o=this.settings,i=o.curl,a=i.epsilon,s=i.speed,l=i.scale,c=i.strength;this.curlEpsilon=new t.Uniform(a),this.curlScale=new t.Uniform(l),this.curlSpeed=new t.Uniform(s/(2*a)),this.curlStrength=new t.Uniform(new t.Vector3(c.x,c.y,c.z)),this.delta=new t.Uniform(0),this.time=new t.Uniform(0),this.wind=new t.Uniform(new t.Vector3);var u={uEpsilon:this.curlEpsilon,uCurlScale:this.curlScale,uCurlSpeed:this.curlSpeed,uCurlStrength:this.curlStrength,uDelta:this.delta,uTime:this.time,uWind:this.wind},f=new h(this.particleCountMax);this.gpgpu=f,f.addVariable("x",{data:e,shader:nn.GPGPU_x,uniforms:vn({uBounds:{value:this.bounds.x}},u)}),f.addVariable("y",{data:n,shader:nn.GPGPU_y,uniforms:vn({uBounds:{value:this.bounds.y}},u)}),f.addVariable("z",{data:r,shader:nn.GPGPU_z,uniforms:vn({uBounds:{value:this.bounds.z}},u)}),f.assign("x","y"),f.assign("x","z"),f.assign("y","x"),f.assign("y","z"),f.assign("z","x"),f.assign("z","y");var d=new t.Color(o.colorLow),p=new t.Color(o.colorHigh);nn.material.uniforms={opacity:new t.Uniform(o.opacity),uBounds:new t.Uniform(this.bounds.y),uColorLow:new t.Uniform(d),uColorHigh:new t.Uniform(p),uRotation:new t.Uniform(o.rotation),uScale:new t.Uniform(new t.Vector3(o.scale.top,o.scale.bottom,o.scale.gradient)),uTime:this.time,GPGPU_x:f.x,GPGPU_y:f.y,GPGPU_z:f.z}}},{key:"updateInstanceCount",value:function(){var e=Math.floor(t.MathUtils.clamp(this.settings.particle.count*this.camera.aspect,this.particleCountMin,this.particleCountMax));this.particles.geometry.instanceCount=e}},{key:"resize",value:function(t,e,n){wn(Sn(a.prototype),"resize",this).call(this,t,e,n),this.particles&&(this.bounds.update(),this.updateInstanceCount())}},{key:"tick",value:function(t){var e=t*this.settings.speed;this.delta.value=e,this.time.value+=e*this.settings.timeFactor,this.gpgpu.tick(),wn(Sn(a.prototype),"tick",this).call(this,t)}}],r&&gn(n.prototype,r),o&&gn(n,o),Object.defineProperty(n,"prototype",{writable:!1}),a}(Dt);function Tn(t){return Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tn(t)}function _n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jn(t,e){return jn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},jn(t,e)}function zn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Rn(t);if(e){var o=Rn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return En(this,n)}}function En(t,e){if(e&&("object"===Tn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Rn(t){return Rn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Rn(t)}var Mn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jn(t,e)}(i,t);var e,n,r,o=zn(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,t)).intensity=0,e}return e=i,n=[{key:"tick",value:function(t){var e=this.sketch,n=this.tracker,r=e.settings,o=Ct.lerp;this.projector.set(n.polarizeX,n.reversePolarizeY),this.projector.tick(t);var i=e.camera.aspect>1?n.centerX:n.centerY;this.intensity=o(this.intensity,i,r.lerpSpeed),e.depth.value=o(r.depth.max,r.depth.min,this.intensity),e.noiseScale.value=o(r.noiseScale.min,r.noiseScale.max,Math.pow(2*this.intensity,2))}}],n&&_n(e.prototype,n),r&&_n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ct),Un={name:"Backgrid",background:{color1:526345,color2:2105123},colorInactive:2236966,colorActive:3817541,dot:{size:.038,margin:.14,rows:128},deltaScale:.002,timeScale:2e-4,camera:{start:{x:0,y:0,z:0}},cursorProjector:{lerp:.007},lerpSpeed:.048,depth:{min:.05,max:.15},noiseScale:{min:.001,max:4}},Dn={};function An(t){return An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},An(t)}function Gn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Bn(){return Bn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=In(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Bn.apply(this,arguments)}function In(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Vn(t)););return t}function Ln(t,e){return Ln=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ln(t,e)}function Yn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Vn(t);if(e){var o=Vn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Xn(this,n)}}function Xn(t,e){if(e&&("object"===An(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Vn(t){return Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Vn(t)}Dn.GPGPU_intensity="\nuniform sampler2D GPGPU_intensity;\nuniform sampler2D GPGPU_offsetX;\nuniform sampler2D GPGPU_offsetY;\nuniform vec3 uCursor;\nuniform float uDelta;\nuniform float uNoiseScale;\nuniform float uTime;\n\n".concat(Jt.floatPack,"\n").concat(Jt.simplex3D,"\n\n\tvoid main() {\n\t\n\t// Read\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\tfloat intensity = unpackFloat( texture2D( GPGPU_intensity, uv ) );\n\n\tfloat offsetX = unpackFloat( texture2D( GPGPU_offsetX, uv ) );\n\tfloat offsetY = unpackFloat( texture2D( GPGPU_offsetY, uv ) );\n\tvec3 offset = vec3( offsetX, offsetY, 0.0 );\n\n\t// Modify\n\n\tfloat simplex = simplex3D( \n\t\toffsetX * uNoiseScale, \n\t\toffsetY * uNoiseScale, \n\t\tuTime\n\t);\n\t\n\tfloat waves = ( simplex + 1.0 ) * 5.0;\n\t\n\tfloat cursorReaction = ( 0.5 + abs( simplex ) ) * clamp(\n\t\t7.0 / ( length( uCursor - offset ) + 0.1 ),\n\t\t0.0,\n\t\t10.0\n\t);\n\n\tfloat targetIntensity = clamp( \n\t\t( clamp( waves + cursorReaction, 0.0, 20.0 ) - 10.0 ) * 0.2,\n\t\t-1.0,\n\t\t1.0\n\t);\n\n\tintensity = mix( intensity, targetIntensity, uDelta );\n\n\t// Write\n\n\tgl_FragColor = packFloat( intensity );\n\n}\n"),Dn.cores=Jt.getBase(),Dn.cores.vertexShader="\nattribute float aOffsetX;\nattribute float aOffsetY;\nattribute vec2 GPGPU_target;\nuniform sampler2D GPGPU_intensity;\nuniform float uDepth;\nvarying float vIntensity;\n".concat(Jt.floatPack,"\n\nvoid main() {\n\n\tfloat intensity = unpackFloat( texture2D( GPGPU_intensity, GPGPU_target ) );\n\tvIntensity = ( intensity + 1.0 ) / 2.0;\n\n\tvec3 transformed = position;\n\ttransformed *= vIntensity;\n\ttransformed += vec3( aOffsetX, aOffsetY, ( intensity - 1.0) * uDepth );\n\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( transformed, 1.0 );\n\n}\n"),Dn.cores.fragmentShader="\nuniform vec3 uColorActive;\nuniform vec3 uColorInactive;\nvarying float vIntensity;\n\nvoid main() {\n\n\tvec3 dynamicColor = mix( uColorInactive, uColorActive, vIntensity );\n\n\tgl_FragColor = vec4( dynamicColor, 1.0 );\n\n}\n",Dn.shells=Jt.getBase(),Dn.shells.vertexShader="\nattribute float aOffsetX;\nattribute float aOffsetY;\nattribute vec2 GPGPU_target;\nuniform sampler2D GPGPU_intensity;\nuniform float uDepth;\nvarying float vIntensity;\n".concat(Jt.floatPack,"\n\nvoid main() {\n\n\tfloat intensity = unpackFloat( texture2D( GPGPU_intensity, GPGPU_target ) );\n\tvIntensity = ( intensity + 1.0 ) / 2.0;\n\n\tvec3 transformed = position;\n\ttransformed *= vIntensity;\n\ttransformed += vec3( aOffsetX, aOffsetY, vIntensity * uDepth );\n\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( transformed, 1.0 );\n\n}\n"),Dn.shells.fragmentShader="\nuniform vec3 uColorActive;\nuniform vec3 uColorInactive;\nvarying float vIntensity;\n\nvoid main() {\n\n\tvec3 dynamicColor = mix( uColorInactive, uColorActive, vIntensity );\n\n\tgl_FragColor = vec4( dynamicColor, 1.0 );\n\n}\n";var Nn=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ln(t,e)}(a,e);var n,r,o,i=Yn(a);function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Gn(this,a),(t=i.call(this,{defaults:Un,settings:e})).offset=0,t}return n=a,r=[{key:"init",value:function(){Bn(Vn(a.prototype),"init",this).call(this,Mn),this.cursor.value=this.controls.cursor.position}},{key:"initScene",value:function(){var e=this.settings,n=new t.Group;this.add(n);for(var r=e.dot.rows,o=r*r,i=e.dot.size,a=i+e.dot.margin,s=a*r,l=(a-s)/2,c=-(a-s)/2,u=new Float32Array(o),f=new Float32Array(o),h=new Float32Array(2*o),d=0,p=0,m=0;m<r;m++)for(var v=0;v<r;v++){var y=l+v*a,b=c-m*a;u[d]=y,f[d]=b,h[p++]=d%r/r,h[p++]=~~(d/r)/r,d++}this.dotCount=o,this.tileSize=a,this.totalSize=s,this.initUniforms(u,f);var g=new t.InstancedBufferAttribute(u,1),w=new t.InstancedBufferAttribute(f,1),x=new t.InstancedBufferAttribute(h,2);function P(t){t.setAttribute("aOffsetX",g),t.setAttribute("aOffsetY",w),t.setAttribute("GPGPU_target",x)}var O=new t.PlaneGeometry(i,i),k=new t.InstancedBufferGeometry;k.instanceCount=o,k.setAttribute("position",(new t.Float32BufferAttribute).copy(O.attributes.position)),k.setIndex((new t.Uint16BufferAttribute).copy(O.index)),P(k);var S=new t.ShaderMaterial(Dn.cores),C=new t.Mesh(k,S);n.add(C);var T=new t.EdgesGeometry(O),_=new t.InstancedBufferGeometry;_.instanceCount=o,_.setAttribute("position",(new t.Float32BufferAttribute).copy(T.attributes.position)),P(_);var j=new t.ShaderMaterial(Dn.shells),z=new t.LineSegments(_,j);n.add(z),this.container=n,this.cores=C,this.shells=z,O.dispose(),T.dispose()}},{key:"initUniforms",value:function(e,n){var r=this.settings;this.colorActive=new t.Color(r.colorActive),this.colorInactive=new t.Color(r.colorInactive),this.cursor=new t.Uniform(null),this.time=new t.Uniform(0),this.delta=new t.Uniform(0),this.depth=new t.Uniform(r.depth.min),this.noiseScale=new t.Uniform(r.noiseScale.max);var o=new h(this.dotCount);o.addConstant("offsetX",e),o.addConstant("offsetY",n),o.addVariable("intensity",{shader:Dn.GPGPU_intensity,uniforms:{GPGPU_offsetX:o.offsetX,GPGPU_offsetY:o.offsetY,uCursor:this.cursor,uDelta:this.delta,uNoiseScale:this.noiseScale,uTime:this.time}}),this.gpgpu=o;var i={GPGPU_intensity:o.intensity,uColorActive:new t.Uniform(this.colorActive),uColorInactive:new t.Uniform(this.colorInactive),uDepth:this.depth};Dn.cores.uniforms=i,Dn.shells.uniforms=i}},{key:"resize",value:function(t,e,n){Bn(Vn(a.prototype),"resize",this).call(this,t,e,n);var r=Math.abs(1-this.camera.aspect);this.camera.position.z=Math.max(8-r,1)}},{key:"tick",value:function(t){this.delta.value=t*this.settings.deltaScale,this.time.value+=t*this.settings.timeScale,this.gpgpu.tick(),this.container.position.x=this.offset%this.tileSize,Bn(Vn(a.prototype),"tick",this).call(this,t)}}],r&&Fn(n.prototype,r),o&&Fn(n,o),Object.defineProperty(n,"prototype",{writable:!1}),a}(Dt);function Hn(t){return Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hn(t)}function Zn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wn(){return Wn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Qn(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Wn.apply(this,arguments)}function Qn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$n(t)););return t}function qn(t,e){return qn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},qn(t,e)}function Kn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=$n(t);if(e){var o=$n(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jn(this,n)}}function Jn(t,e){if(e&&("object"===Hn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function $n(t){return $n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},$n(t)}var tr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qn(t,e)}(i,t);var e,n,r,o=Kn(i);function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t)}return e=i,n=[{key:"initGUI",value:function(){Wn($n(i.prototype),"initGUI",this).call(this);var t=Ct.VALUE,e=this.gui,n=this.sketch,r=e.addFolder("Colors");r.addColor(n.background,"color1").name("background1"),r.addColor(n.background,"color2").name("background2"),r.addColor(n.color,t).name("particle"),r.add(n.opacity,t,0,1).name("opacity")}}],n&&Zn(e.prototype,n),r&&Zn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ct),er={name:"Cyberdark",background:{color1:"#060610",color2:"#262627"},depth:50,particle:{color:"#323739",opacity:.6,size:.04,length:5,count:6e3,bounds:{x:30,y:10},noiseScale:.2,variance:1.4},speed:{value:.004},bloom:{strength:.2,radius:1,threshold:.2},random:!0},nr=Jt.getBase();function rr(t){return rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rr(t)}function or(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ir(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ar(){return ar="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=sr(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},ar.apply(this,arguments)}function sr(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=fr(t)););return t}function lr(t,e){return lr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},lr(t,e)}function cr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=fr(t);if(e){var o=fr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ur(this,n)}}function ur(t,e){if(e&&("object"===rr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function fr(t){return fr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},fr(t)}nr.vertexShader="\nattribute float aSpeed;\nattribute vec3 aOffset;\nuniform float uDepth;\nuniform float uTraveled;\nvarying float vIntensity;\n\n".concat(Jt.parabola,"\n\nvoid main() {\n\n\tvec3 offset = aOffset;\n\toffset.z = mod( offset.z + uTraveled * aSpeed, uDepth );\n\n\tfloat progress = offset.z / uDepth;\n\tvIntensity = pow( progress, 2.0 );\n\n\tfloat scale = mix( progress, parabola( progress, 2.0 ), 0.8 );\n\n\tvec3 transformed = position * scale + offset;\n\ttransformed.z *= aSpeed * 1.5;\n\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( transformed, 1.0 );\n\n}\n"),nr.fragmentShader="\nuniform vec3 color;\nuniform float opacity;\nvarying float vIntensity;\n\nvoid main() {\n\n\tvec3 dynamicColor = color;\n\tfloat dynamicOpacity = opacity * vIntensity;\n\n\tgl_FragColor = vec4( dynamicColor, opacity );\n\n}\n";var hr=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lr(t,e)}(a,e);var n,r,o,i=cr(a);function a(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return or(this,a),(e=i.call(this,{defaults:er,settings:n})).simplex=new T(e.random),e.traveled=new t.Uniform(0),e.depth=new t.Uniform(e.settings.depth),e.speed=e.settings.speed.value,e.offset=0,e}return n=a,(r=[{key:"init",value:function(){ar(fr(a.prototype),"init",this).call(this,tr)}},{key:"initScene",value:function(){for(var e=this.random,n=this.simplex,r=this.settings.particle,o=r.color,i=r.opacity,a=r.size,s=r.length,l=r.count,c=r.noiseScale,u=r.bounds,f=r.variance,h=new t.BoxGeometry(a,a,a*s),d=new t.EdgesGeometry(h),p=3*l,m=new Float32Array(p),v=new Float32Array(l),y=0,b=0;y<p;y+=3){var g=e.number(0,this.depth.value),w=n.noise2D(g*c,y*c)*u.y,x=n.noise2D(w*c,g*c)*u.x;m[y]=x,m[y+1]=w,m[y+2]=g,v[b++]=f*(.5+.5*n.noise3D(x,w,g))}var P=new t.InstancedBufferGeometry;P.instanceCount=l,P.setAttribute("position",(new t.Float32BufferAttribute).copy(d.attributes.position)),P.setAttribute("aOffset",new t.InstancedBufferAttribute(m,3)),P.setAttribute("aSpeed",new t.InstancedBufferAttribute(v,1)),this.color=new t.Uniform(new t.Color(o)),this.opacity=new t.Uniform(i),nr.uniforms={color:this.color,opacity:this.opacity,uDepth:this.depth,uTraveled:this.traveled};var O=new t.ShaderMaterial(nr),k=new t.LineSegments(P,O);k.frustumCulled=!1,k.position.z=-this.depth.value,this.add(k),this.particles=k,h.dispose(),d.dispose()}},{key:"tick",value:function(t){this.traveled.value+=t*this.speed,ar(fr(a.prototype),"tick",this).call(this,t)}}])&&ir(n.prototype,r),o&&ir(n,o),Object.defineProperty(n,"prototype",{writable:!1}),a}(Dt),dr=new b({container:"background"});h.init(dr.renderer);var pr={sketchpad:dr,gui:!0},mr={ablaze:function(){return new Cn(pr)},backgrid:function(){return new Nn(pr)},blockflow:function(){return new Je(pr)},cyberdark:function(){return new hr(pr)},navscan:function(){return new ze(pr)},rain:function(){return new ce(pr)}},vr=(mr[window.location.hash.replace("#","")]||mr.navscan)();dr.init(vr),document.title="".concat(vr.settings.name," - Pierre Keda");var yr=document.getElementById("main");yr.classList.add("show"),setTimeout((function(){return yr.classList.remove("show")}),2500)})();